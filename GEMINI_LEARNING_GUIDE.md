# CoinVueï¼ˆå¹£æ™¯ï¼‰å®Œæ•´é–‹ç™¼å­¸ç¿’æŒ‡å— - Gemini å¼•å°å¼å­¸ç¿’ç‰ˆ

> é€™æ˜¯ä¸€ä»½å°ˆç‚º Gemini AI å¼•å°å¼å­¸ç¿’åŠŸèƒ½è¨­è¨ˆçš„å®Œæ•´å°ˆæ¡ˆé–‹ç™¼æŒ‡å—ã€‚
> è«‹å°‡æ­¤æ–‡æª”æä¾›çµ¦ Geminiï¼Œè®“å®ƒæ‰‹æŠŠæ‰‹å¸¶ä½ å¾é›¶é–‹å§‹å®Œæˆæ•´å€‹å°ˆæ¡ˆã€‚

---

## ğŸ“Œ çµ¦ Gemini AI çš„æŒ‡ç¤º

è¦ªæ„›çš„ Geminiï¼Œè«‹æ ¹æ“šä»¥ä¸‹å­¸ç¿’è·¯å¾‘ï¼Œ**æ‰‹æŠŠæ‰‹ã€å¾ªåºæ¼¸é€²**åœ°å¼•å°å­¸ç¿’è€…å®Œæˆ CoinVueï¼ˆå¹£æ™¯ï¼‰å°ˆæ¡ˆã€‚

### ä½ çš„è§’è‰²å®šä½
ä½ æ˜¯ä¸€ä½ç¶“é©—è±å¯Œçš„å…¨ç«¯é–‹ç™¼å°å¸«ï¼Œéœ€è¦ï¼š
1. **é€æ­¥æ•™å­¸**ï¼šæ¯æ¬¡åªæ•™ä¸€å€‹å°æ­¥é©Ÿï¼Œç¢ºä¿å­¸ç¿’è€…ç†è§£å¾Œå†ç¹¼çºŒ
2. **è©³ç´°è§£é‡‹**ï¼šè§£é‡‹æ¯æ®µä»£ç¢¼çš„ä½œç”¨ã€ç‚ºä»€éº¼é€™æ¨£å¯«ã€æœ‰ä»€éº¼æ›¿ä»£æ–¹æ¡ˆ
3. **ä¸»å‹•æå•**ï¼šå®šæœŸæª¢æŸ¥å­¸ç¿’è€…çš„ç†è§£ç¨‹åº¦
4. **æä¾›ç¤ºä¾‹**ï¼šçµ¦å‡ºå®Œæ•´çš„ä»£ç¢¼ç¯„ä¾‹ï¼Œä¸¦æ¨™è¨»é‡é»
5. **éŒ¯èª¤è™•ç†**ï¼šé æ¸¬å¯èƒ½é‡åˆ°çš„å•é¡Œï¼Œæå‰èªªæ˜è§£æ±ºæ–¹æ¡ˆ
6. **æœ€ä½³å¯¦è¸**ï¼šåœ¨é©ç•¶æ™‚æ©Ÿä»‹ç´¹æ¥­ç•Œæœ€ä½³å¯¦è¸å’Œè¨­è¨ˆæ¨¡å¼

### æ•™å­¸ç¯€å¥
- æ¯å€‹æ­¥é©Ÿå®Œæˆå¾Œï¼Œè©¢å•å­¸ç¿’è€…ï¼šã€Œé€™éƒ¨åˆ†ç†è§£äº†å—ï¼Ÿæœ‰æ²’æœ‰å•é¡Œï¼Ÿã€
- ç¢ºèªç†è§£å¾Œæ‰é€²å…¥ä¸‹ä¸€æ­¥
- å¦‚æœå­¸ç¿’è€…é‡åˆ°å›°é›£ï¼Œæä¾›æ›´è©³ç´°çš„è§£é‡‹å’Œæ›¿ä»£æ–¹æ¡ˆ
- å®šæœŸå›é¡§å·²å®Œæˆçš„éƒ¨åˆ†ï¼Œç¢ºä¿çŸ¥è­˜é€£è²«

---

## ğŸ¯ å°ˆæ¡ˆæ¦‚è¿°

### å°ˆæ¡ˆåç¨±
**CoinVueï¼ˆå¹£æ™¯ï¼‰** - å°ˆæ¥­çš„åŠ å¯†è²¨å¹£å¸‚å ´ç›£æ§å¹³å°

### å°ˆæ¡ˆç›®æ¨™
æ‰“é€ ä¸€å€‹å…¨åŠŸèƒ½çš„åŠ å¯†è²¨å¹£å„€è¡¨æ¿ï¼ŒåŒ…å«ï¼š
- å³æ™‚åƒ¹æ ¼è¿½è¹¤
- å¸‚å ´ç¸½è¦½èˆ‡é€²éšç¯©é¸
- å€‹äººæ”¶è—æ¸…å–®ï¼ˆWatchlistï¼‰
- å¹£ç¨®æ¯”è¼ƒå·¥å…·
- ç”¨æˆ¶èªè­‰ç³»çµ±ï¼ˆJWTï¼‰
- ç®¡ç†å“¡å¾Œå°ï¼ˆçµ±è¨ˆã€ç”¨æˆ¶ç®¡ç†ã€å…¬å‘Šç³»çµ±ï¼‰

### æŠ€è¡“æ£§ç¸½è¦½

**å‰ç«¯**
- Vue 3.5.22 - ç¾ä»£åŒ–çš„æ¼¸é€²å¼ JavaScript æ¡†æ¶
- Vite 7.1.11 - æ¥µé€Ÿçš„å‰ç«¯å»ºæ§‹å·¥å…·
- Pinia 3.0.3 - Vue å®˜æ–¹æ¨è–¦çš„ç‹€æ…‹ç®¡ç†å·¥å…·
- Vue Router 4.6.3 - å®˜æ–¹è·¯ç”±ç®¡ç†
- vue-i18n 9.14.5 - åœ‹éš›åŒ–ï¼ˆä¸­è‹±æ–‡é›™èªï¼‰

**å¾Œç«¯**
- Spring Boot 3.2.0 - Java ä¼æ¥­ç´šæ¡†æ¶
- Spring Security - å®‰å…¨æ¡†æ¶ï¼ˆJWT èªè­‰ï¼‰
- Spring Data JPA - ORM æ¡†æ¶ï¼ˆHibernateï¼‰
- MySQL 8.0 - é—œè¯å¼è³‡æ–™åº«
- Maven 3.8+ - å°ˆæ¡ˆç®¡ç†å·¥å…·

**API æ•¸æ“šæº**
- CoinGecko API - ä¸»è¦æ•¸æ“šä¾†æºï¼ˆ30 æ¬¡/åˆ†é˜ï¼‰
- CoinCap API - å‚™æ´æ•¸æ“šä¾†æºï¼ˆ200 æ¬¡/åˆ†é˜ï¼‰

### å­¸ç¿’æ™‚ç¨‹é ä¼°
- **ç¸½æ™‚é•·**ï¼šç´„ 80-100 å°æ™‚ï¼ˆ12-15 é€±ï¼‰
- **æ¯é€±å»ºè­°**ï¼š6-8 å°æ™‚å­¸ç¿’æ™‚é–“
- **é›£åº¦**ï¼šä¸­é«˜ç´šï¼ˆéœ€è¦åŸºç¤çš„å‰ç«¯å’Œå¾Œç«¯çŸ¥è­˜ï¼‰

---

## ğŸ“š å­¸ç¿’è·¯å¾‘è¦åŠƒï¼ˆ15 é€±ï¼‰

### ç¬¬ä¸€éšæ®µï¼šç’°å¢ƒæº–å‚™èˆ‡åŸºç¤èªè­˜ï¼ˆç¬¬ 1-2 é€±ï¼‰
### ç¬¬äºŒéšæ®µï¼šå¾Œç«¯åŸºç¤å»ºè¨­ï¼ˆç¬¬ 3-5 é€±ï¼‰
### ç¬¬ä¸‰éšæ®µï¼šå‰ç«¯åŸºç¤å»ºè¨­ï¼ˆç¬¬ 6-8 é€±ï¼‰
### ç¬¬å››éšæ®µï¼šå‰å¾Œç«¯æ•´åˆï¼ˆç¬¬ 9-10 é€±ï¼‰
### ç¬¬äº”éšæ®µï¼šé€²éšåŠŸèƒ½å¯¦ä½œï¼ˆç¬¬ 11-13 é€±ï¼‰
### ç¬¬å…­éšæ®µï¼šå„ªåŒ–èˆ‡éƒ¨ç½²ï¼ˆç¬¬ 14-15 é€±ï¼‰

---

## ğŸš€ ç¬¬ä¸€éšæ®µï¼šç’°å¢ƒæº–å‚™èˆ‡åŸºç¤èªè­˜ï¼ˆç¬¬ 1-2 é€±ï¼‰

### Week 1, Day 1-2ï¼šé–‹ç™¼ç’°å¢ƒå®‰è£

#### ç›®æ¨™
å®‰è£æ‰€æœ‰å¿…è¦çš„é–‹ç™¼å·¥å…·

#### éœ€è¦å®‰è£çš„å·¥å…·

**1. Node.js èˆ‡ npm**
- ä¸‹è¼‰ï¼šhttps://nodejs.org/ï¼ˆé¸æ“‡ LTS ç‰ˆæœ¬ï¼‰
- é©—è­‰å®‰è£ï¼š
  ```bash
  node -v  # æ‡‰é¡¯ç¤º v18.x.x æˆ–æ›´é«˜ç‰ˆæœ¬
  npm -v   # æ‡‰é¡¯ç¤º 9.x.x æˆ–æ›´é«˜ç‰ˆæœ¬
  ```

**2. Java Development Kit (JDK) 17**
- ä¸‹è¼‰ï¼šhttps://adoptium.net/ï¼ˆé¸æ“‡ JDK 17 LTSï¼‰
- é©—è­‰å®‰è£ï¼š
  ```bash
  java -version  # æ‡‰é¡¯ç¤º openjdk version "17.x.x"
  ```

**3. Maven**
- Windows ç”¨æˆ¶ï¼š
  ```bash
  choco install maven -y  # éœ€å…ˆå®‰è£ Chocolatey
  ```
- Mac ç”¨æˆ¶ï¼š
  ```bash
  brew install maven
  ```
- é©—è­‰å®‰è£ï¼š
  ```bash
  mvn -v  # æ‡‰é¡¯ç¤º Apache Maven 3.8.x
  ```

**4. MySQL 8.0**
- ä¸‹è¼‰ï¼šhttps://dev.mysql.com/downloads/mysql/
- å®‰è£éç¨‹ä¸­è¨­å®š root å¯†ç¢¼ï¼ˆè«‹è¨˜ä½é€™å€‹å¯†ç¢¼ï¼‰
- é©—è­‰å®‰è£ï¼š
  ```bash
  mysql --version  # æ‡‰é¡¯ç¤º mysql Ver 8.0.x
  ```

**5. IDE / ç·¨è¼¯å™¨**
- **å‰ç«¯æ¨è–¦**ï¼šVS Codeï¼ˆhttps://code.visualstudio.com/ï¼‰
  - å®‰è£æ“´å……å¥—ä»¶ï¼šVue Language Features (Volar)ã€ESLintã€Prettier
- **å¾Œç«¯æ¨è–¦**ï¼šEclipseï¼ˆhttps://www.eclipse.org/downloads/ï¼‰æˆ– IntelliJ IDEA

**6. Git**
- ä¸‹è¼‰ï¼šhttps://git-scm.com/
- é©—è­‰å®‰è£ï¼š
  ```bash
  git --version
  ```

**7. Postmanï¼ˆé¸æ“‡æ€§ï¼‰**
- ä¸‹è¼‰ï¼šhttps://www.postman.com/downloads/
- ç”¨æ–¼æ¸¬è©¦ APIï¼ˆå°ˆæ¡ˆå·²æ•´åˆ Swagger UIï¼Œå¯æ›¿ä»£ï¼‰

#### å­¸ç¿’æª¢æŸ¥é»
- [ ] æ‰€æœ‰å·¥å…·å®‰è£å®Œæˆ
- [ ] å¯ä»¥åœ¨çµ‚ç«¯æ©ŸåŸ·è¡Œ nodeã€javaã€mvnã€mysql æŒ‡ä»¤
- [ ] IDE å¯ä»¥æ­£å¸¸é–‹å•Ÿ

**Gemini æç¤º**ï¼šè«‹é€ä¸€ç¢ºèªå­¸ç¿’è€…æ˜¯å¦æˆåŠŸå®‰è£æ¯å€‹å·¥å…·ï¼Œé‡åˆ°å•é¡Œæ™‚æä¾›è§£æ±ºæ–¹æ¡ˆã€‚

---

### Week 1, Day 3-4ï¼šå°ˆæ¡ˆåˆå§‹åŒ–

#### ç›®æ¨™
å»ºç«‹å°ˆæ¡ˆè³‡æ–™å¤¾çµæ§‹ï¼Œåˆå§‹åŒ–å‰å¾Œç«¯å°ˆæ¡ˆ

#### æ­¥é©Ÿ 1ï¼šå»ºç«‹å°ˆæ¡ˆæ ¹ç›®éŒ„

```bash
# åœ¨ä½ çš„å·¥ä½œç›®éŒ„ä¸‹å»ºç«‹å°ˆæ¡ˆè³‡æ–™å¤¾
mkdir CryptoDashboard
cd CryptoDashboard
```

#### æ­¥é©Ÿ 2ï¼šåˆå§‹åŒ– Git

```bash
git init
echo "node_modules/" > .gitignore
echo "target/" >> .gitignore
echo ".env" >> .gitignore
echo "*.log" >> .gitignore
```

#### æ­¥é©Ÿ 3ï¼šå»ºç«‹å°ˆæ¡ˆçµæ§‹

```bash
# å»ºç«‹ä¸»è¦è³‡æ–™å¤¾
mkdir frontend
mkdir backend
mkdir database
mkdir docs
```

æœ€çµ‚çµæ§‹æ‡‰å¦‚ä¸‹ï¼š
```
CryptoDashboard/
â”œâ”€â”€ frontend/      # Vue 3 å‰ç«¯å°ˆæ¡ˆ
â”œâ”€â”€ backend/       # Spring Boot å¾Œç«¯å°ˆæ¡ˆ
â”œâ”€â”€ database/      # MySQL è³‡æ–™åº«è…³æœ¬
â”œâ”€â”€ docs/          # å°ˆæ¡ˆæ–‡æª”
â””â”€â”€ .gitignore
```

#### æ­¥é©Ÿ 4ï¼šåˆå§‹åŒ–å‰ç«¯å°ˆæ¡ˆ

```bash
cd frontend

# ä½¿ç”¨ Vite å»ºç«‹ Vue 3 å°ˆæ¡ˆ
npm create vite@latest . -- --template vue

# å®‰è£ä¾è³´
npm install

# æ¸¬è©¦é‹è¡Œ
npm run dev
```

è¨ªå• http://localhost:5173ï¼Œæ‡‰è©²æœƒçœ‹åˆ° Vite + Vue çš„æ­¡è¿é é¢ã€‚

#### æ­¥é©Ÿ 5ï¼šå®‰è£å‰ç«¯ä¾è³´å¥—ä»¶

```bash
# æ ¸å¿ƒä¾è³´
npm install vue-router@4 pinia@2 axios@1

# åœ‹éš›åŒ–
npm install vue-i18n@9

# å·¥å…·å‡½æ•¸
npm install date-fns@2
```

#### æ­¥é©Ÿ 6ï¼šåˆå§‹åŒ–å¾Œç«¯å°ˆæ¡ˆï¼ˆä½¿ç”¨ Spring Initializrï¼‰

æ–¹å¼ Aï¼šä½¿ç”¨ç¶²é ç‰ˆ
1. è¨ªå• https://start.spring.io/
2. è¨­å®šå°ˆæ¡ˆï¼š
   - Project: Maven
   - Language: Java
   - Spring Boot: 3.2.0
   - Group: com.crypto
   - Artifact: dashboard
   - Packaging: Jar
   - Java: 17
3. æ–°å¢ä¾è³´ï¼š
   - Spring Web
   - Spring Data JPA
   - Spring Security
   - MySQL Driver
   - Lombok
4. é»æ“Š Generateï¼Œä¸‹è¼‰ zip æª”
5. è§£å£“ç¸®åˆ° `backend/` è³‡æ–™å¤¾

æ–¹å¼ Bï¼šä½¿ç”¨ Spring Boot CLIï¼ˆé€²éšï¼‰
```bash
spring init --dependencies=web,data-jpa,security,mysql,lombok \
  --build=maven --java-version=17 --boot-version=3.2.0 \
  --groupId=com.crypto --artifactId=dashboard \
  backend
```

#### å­¸ç¿’æª¢æŸ¥é»
- [ ] å°ˆæ¡ˆè³‡æ–™å¤¾çµæ§‹æ­£ç¢º
- [ ] å‰ç«¯å¯ä»¥é‹è¡Œï¼ˆhttp://localhost:5173ï¼‰
- [ ] å¾Œç«¯å°ˆæ¡ˆè³‡æ–™å¤¾å­˜åœ¨ä¸”åŒ…å« pom.xml

**Gemini æç¤º**ï¼šç¢ºèªå­¸ç¿’è€…çš„å°ˆæ¡ˆçµæ§‹æ­£ç¢ºï¼Œå‰ç«¯å¯ä»¥æ­£å¸¸å•Ÿå‹•ã€‚

---

### Week 1, Day 5-7ï¼šæ ¸å¿ƒæ¦‚å¿µå­¸ç¿’

#### ç›®æ¨™
ç†è§£å°ˆæ¡ˆä¸­ä½¿ç”¨çš„æ ¸å¿ƒæŠ€è¡“å’Œæ¦‚å¿µ

#### å¿…é ˆç†è§£çš„å‰ç«¯æ¦‚å¿µ

**1. Vue 3 Composition API**
- ä»€éº¼æ˜¯ Composition APIï¼Ÿèˆ‡ Options API çš„å·®ç•°ï¼Ÿ
- `setup()` å‡½æ•¸çš„ä½œç”¨
- `ref` å’Œ `reactive` çš„å·®ç•°
- `computed` å’Œ `watch` çš„ä½¿ç”¨æ™‚æ©Ÿ

**å­¸ç¿’è³‡æº**ï¼š
- Vue 3 å®˜æ–¹æ–‡æª”ï¼šhttps://vuejs.org/guide/introduction.html
- é‡é»é–±è®€ï¼šEssentialsã€Reactivityã€Components In-Depth

**2. Pinia ç‹€æ…‹ç®¡ç†**
- ç‚ºä»€éº¼éœ€è¦ç‹€æ…‹ç®¡ç†ï¼Ÿ
- Pinia çš„ Store æ˜¯ä»€éº¼ï¼Ÿ
- `state`ã€`getters`ã€`actions` çš„ä½œç”¨
- å¦‚ä½•åœ¨å…ƒä»¶ä¸­ä½¿ç”¨ Storeï¼Ÿ

**å­¸ç¿’è³‡æº**ï¼š
- Pinia å®˜æ–¹æ–‡æª”ï¼šhttps://pinia.vuejs.org/introduction.html

**3. Vue Router**
- ä»€éº¼æ˜¯å–®é é¢æ‡‰ç”¨ï¼ˆSPAï¼‰ï¼Ÿ
- è·¯ç”±é…ç½®çš„åŸºæœ¬çµæ§‹
- å‹•æ…‹è·¯ç”±åƒæ•¸ï¼ˆå¦‚ `/coin/:id`ï¼‰
- è·¯ç”±å®ˆè¡›ï¼ˆNavigation Guardsï¼‰çš„ä½œç”¨

**å­¸ç¿’è³‡æº**ï¼š
- Vue Router å®˜æ–¹æ–‡æª”ï¼šhttps://router.vuejs.org/guide/

#### å¿…é ˆç†è§£çš„å¾Œç«¯æ¦‚å¿µ

**1. Spring Boot åŸºç¤**
- ä»€éº¼æ˜¯ Spring Bootï¼Ÿèˆ‡å‚³çµ± Spring çš„å·®ç•°ï¼Ÿ
- ä¾è³´æ³¨å…¥ï¼ˆDependency Injectionï¼‰æ˜¯ä»€éº¼ï¼Ÿ
- `@Component`ã€`@Service`ã€`@Controller` çš„å·®ç•°
- `application.yml` é…ç½®æª”çš„ä½œç”¨

**å­¸ç¿’è³‡æº**ï¼š
- Spring Boot å®˜æ–¹æŒ‡å—ï¼šhttps://spring.io/guides/gs/spring-boot/

**2. JPA/Hibernate**
- ORMï¼ˆObject-Relational Mappingï¼‰æ˜¯ä»€éº¼ï¼Ÿ
- JPA Entity é¡åˆ¥çš„ä½œç”¨
- `@Entity`ã€`@Id`ã€`@GeneratedValue` ç­‰è¨»è§£çš„æ„ç¾©
- JPA Repository çš„åŸºæœ¬ä½¿ç”¨

**å­¸ç¿’è³‡æº**ï¼š
- Spring Data JPA æŒ‡å—ï¼šhttps://spring.io/guides/gs/accessing-data-jpa/

**3. Spring Security + JWT**
- ä»€éº¼æ˜¯ JWTï¼ˆJSON Web Tokenï¼‰ï¼Ÿ
- ç‚ºä»€éº¼ä¸ä½¿ç”¨å‚³çµ±çš„ Sessionï¼Ÿ
- JWT çš„çµæ§‹ï¼ˆHeaderã€Payloadã€Signatureï¼‰
- Bearer Token æ˜¯ä»€éº¼ï¼Ÿ

**å­¸ç¿’è³‡æº**ï¼š
- JWT å®˜ç¶²ï¼šhttps://jwt.io/introduction

**4. RESTful API è¨­è¨ˆåŸå‰‡**
- REST çš„åŸºæœ¬æ¦‚å¿µ
- HTTP æ–¹æ³•ï¼ˆGETã€POSTã€PUTã€DELETEï¼‰çš„ä½¿ç”¨æ™‚æ©Ÿ
- HTTP ç‹€æ…‹ç¢¼ï¼ˆ200ã€201ã€400ã€401ã€404ã€500ï¼‰çš„æ„ç¾©
- API ç«¯é»å‘½åè¦ç¯„

**å­¸ç¿’è³‡æº**ï¼š
- RESTful API è¨­è¨ˆæŒ‡å—ï¼šhttps://restfulapi.net/

#### å­¸ç¿’ä½œæ¥­

**ä½œæ¥­ 1ï¼šå»ºç«‹ä¸€å€‹ç°¡å–®çš„ Vue 3 å…ƒä»¶**
ç›®æ¨™ï¼šç†Ÿæ‚‰ Composition API

```vue
<!-- å»ºç«‹ frontend/src/components/HelloWorld.vue -->
<template>
  <div>
    <h1>{{ message }}</h1>
    <p>è¨ˆæ•¸å™¨: {{ count }}</p>
    <button @click="increment">å¢åŠ </button>
  </div>
</template>

<script setup>
import { ref } from 'vue'

const message = ref('Hello, CoinVue!')
const count = ref(0)

const increment = () => {
  count.value++
}
</script>

<style scoped>
button {
  padding: 10px 20px;
  font-size: 16px;
}
</style>
```

**ä½œæ¥­ 2ï¼šå»ºç«‹ä¸€å€‹ç°¡å–®çš„ Spring Boot Controller**
ç›®æ¨™ï¼šç†è§£ REST API çš„åŸºæœ¬çµæ§‹

```java
// å»ºç«‹ backend/src/main/java/com/crypto/dashboard/controller/TestController.java
package com.crypto.dashboard.controller;

import org.springframework.web.bind.annotation.*;

@RestController
@RequestMapping("/api/test")
public class TestController {

    @GetMapping("/hello")
    public String hello() {
        return "Hello from Spring Boot!";
    }

    @GetMapping("/echo/{message}")
    public String echo(@PathVariable String message) {
        return "Echo: " + message;
    }
}
```

#### å­¸ç¿’æª¢æŸ¥é»
- [ ] ç†è§£ Vue 3 Composition API çš„åŸºæœ¬æ¦‚å¿µ
- [ ] ç†è§£ Pinia ç‹€æ…‹ç®¡ç†çš„ä½œç”¨
- [ ] ç†è§£ Spring Boot ä¸‰å±¤æ¶æ§‹ï¼ˆControllerã€Serviceã€Repositoryï¼‰
- [ ] ç†è§£ JWT èªè­‰çš„åŸºæœ¬åŸç†
- [ ] ç†è§£ RESTful API è¨­è¨ˆè¦ç¯„

**Gemini æç¤º**ï¼š
- ç”¨ç°¡å–®çš„æ¯”å–»è§£é‡‹é€™äº›æ¦‚å¿µ
- ç¢ºèªå­¸ç¿’è€…ç†è§£æ¯å€‹æ¦‚å¿µçš„ã€Œç‚ºä»€éº¼ã€ï¼Œè€Œä¸åªæ˜¯ã€Œæ€éº¼åšã€
- é¼“å‹µå­¸ç¿’è€…å®Œæˆä½œæ¥­ä¸¦è¦ªè‡ªæ¸¬è©¦

---

### Week 2ï¼šè³‡æ–™åº«è¨­è¨ˆèˆ‡å»ºç«‹

#### ç›®æ¨™
ç†è§£è³‡æ–™åº«è¨­è¨ˆåŸå‰‡ï¼Œå»ºç«‹ MySQL è³‡æ–™åº«

#### Day 1-2ï¼šè³‡æ–™åº«è¨­è¨ˆç†è«–

**å­¸ç¿’é‡é»**
1. **æ­£è¦åŒ–ï¼ˆNormalizationï¼‰**
   - ç¬¬ä¸€æ­£è¦åŒ–ï¼ˆ1NFï¼‰ï¼šæ¯å€‹æ¬„ä½éƒ½æ˜¯åŸå­æ€§çš„
   - ç¬¬äºŒæ­£è¦åŒ–ï¼ˆ2NFï¼‰ï¼šæ¶ˆé™¤éƒ¨åˆ†ç›¸ä¾
   - ç¬¬ä¸‰æ­£è¦åŒ–ï¼ˆ3NFï¼‰ï¼šæ¶ˆé™¤éç§»ç›¸ä¾

2. **ä¸»éµï¼ˆPrimary Keyï¼‰**
   - è‡ªå‹•éå¢ ID vs UUID
   - æœ¬å°ˆæ¡ˆé¸æ“‡ï¼šAUTO_INCREMENT BIGINT

3. **å¤–éµï¼ˆForeign Keyï¼‰**
   - å»ºç«‹è¡¨æ ¼ä¹‹é–“çš„é—œè¯
   - CASCADE DELETE çš„ä½œç”¨

4. **ç´¢å¼•ï¼ˆIndexï¼‰**
   - æå‡æŸ¥è©¢æ•ˆèƒ½
   - é©åˆå»ºç«‹ç´¢å¼•çš„æ¬„ä½ï¼ˆå¸¸ç”¨æ–¼ WHEREã€JOIN çš„æ¬„ä½ï¼‰

#### Day 3-5ï¼šå»ºç«‹è³‡æ–™åº«çµæ§‹

**æ­¥é©Ÿ 1ï¼šå»ºç«‹è³‡æ–™åº«è…³æœ¬**

å»ºç«‹æª”æ¡ˆ `database/schema_v3.sql`ï¼š

```sql
-- ============================================
-- CoinVueï¼ˆå¹£æ™¯ï¼‰è³‡æ–™åº«çµæ§‹ v3.0
-- ============================================

-- å»ºç«‹è³‡æ–™åº«
CREATE DATABASE IF NOT EXISTS crypto_dashboard
CHARACTER SET utf8mb4
COLLATE utf8mb4_unicode_ci;

USE crypto_dashboard;

-- ============================================
-- æ ¸å¿ƒè¡¨æ ¼ï¼ˆv1.0ï¼‰
-- ============================================

-- 1. users è¡¨ - ä½¿ç”¨è€…è³‡æ–™
CREATE TABLE users (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    username VARCHAR(50) NOT NULL UNIQUE,
    email VARCHAR(100) NOT NULL UNIQUE,
    password VARCHAR(255) NOT NULL,
    role ENUM('user', 'admin') DEFAULT 'user',
    status ENUM('active', 'inactive', 'suspended') DEFAULT 'active',
    preferred_language VARCHAR(10) DEFAULT 'zh-TW',
    join_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    last_login TIMESTAMP NULL,
    INDEX idx_email (email),
    INDEX idx_username (username)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- 2. auth_tokens è¡¨ - JWT Token ç®¡ç†
CREATE TABLE auth_tokens (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    user_id BIGINT NOT NULL,
    token VARCHAR(500) NOT NULL UNIQUE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    expires_at TIMESTAMP NOT NULL,
    is_valid BOOLEAN DEFAULT TRUE,
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,
    INDEX idx_token (token),
    INDEX idx_user_id (user_id),
    INDEX idx_expires_at (expires_at)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- 3. coin_favorites è¡¨ - æ”¶è—æ¸…å–®
CREATE TABLE coin_favorites (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    user_id BIGINT NOT NULL,
    coin_id VARCHAR(50) NOT NULL,
    added_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,
    UNIQUE KEY unique_user_coin (user_id, coin_id),
    INDEX idx_user_id (user_id),
    INDEX idx_coin_id (coin_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- 4. announcements è¡¨ - ç³»çµ±å…¬å‘Š
CREATE TABLE announcements (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    title VARCHAR(200) NOT NULL,
    content TEXT NOT NULL,
    type ENUM('info', 'success', 'warning') DEFAULT 'info',
    is_active BOOLEAN DEFAULT TRUE,
    created_by BIGINT NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (created_by) REFERENCES users(id) ON DELETE CASCADE,
    INDEX idx_is_active (is_active),
    INDEX idx_created_at (created_at)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- ============================================
-- æ“´å……è¡¨æ ¼ï¼ˆv3.0 - æœªä¾†åŠŸèƒ½ï¼‰
-- ============================================

-- 5. user_activities è¡¨ - ç”¨æˆ¶æ´»å‹•è¨˜éŒ„
CREATE TABLE user_activities (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    user_id BIGINT NOT NULL,
    activity_type VARCHAR(50) NOT NULL,
    activity_data JSON,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,
    INDEX idx_user_id (user_id),
    INDEX idx_activity_type (activity_type),
    INDEX idx_created_at (created_at)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- 6. market_filter_presets è¡¨ - å¸‚å ´ç¯©é¸é è¨­
CREATE TABLE market_filter_presets (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    user_id BIGINT NOT NULL,
    preset_name VARCHAR(100) NOT NULL,
    filter_data JSON NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,
    INDEX idx_user_id (user_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- 7. coin_price_alerts è¡¨ - åƒ¹æ ¼æé†’
CREATE TABLE coin_price_alerts (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    user_id BIGINT NOT NULL,
    coin_id VARCHAR(50) NOT NULL,
    target_price DECIMAL(20, 8) NOT NULL,
    condition_type ENUM('above', 'below') NOT NULL,
    is_triggered BOOLEAN DEFAULT FALSE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    triggered_at TIMESTAMP NULL,
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,
    INDEX idx_user_id (user_id),
    INDEX idx_coin_id (coin_id),
    INDEX idx_is_triggered (is_triggered)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- 8. coin_comparisons è¡¨ - å¹£ç¨®æ¯”è¼ƒæ­·å²
CREATE TABLE coin_comparisons (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    user_id BIGINT NOT NULL,
    coin_ids JSON NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,
    INDEX idx_user_id (user_id),
    INDEX idx_created_at (created_at)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- 9. system_settings è¡¨ - ç³»çµ±è¨­å®š
CREATE TABLE system_settings (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    setting_key VARCHAR(100) NOT NULL UNIQUE,
    setting_value TEXT NOT NULL,
    description VARCHAR(255),
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    INDEX idx_setting_key (setting_key)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
```

**æ­¥é©Ÿ 2ï¼šåŸ·è¡Œè³‡æ–™åº«è…³æœ¬**

```bash
# é€£æ¥ MySQL ä¸¦åŸ·è¡Œè…³æœ¬
mysql -u root -p < database/schema_v3.sql

# é©—è­‰è³‡æ–™åº«å»ºç«‹æˆåŠŸ
mysql -u root -p -e "USE crypto_dashboard; SHOW TABLES;"
```

æ‡‰è©²æœƒçœ‹åˆ° 9 å€‹è¡¨æ ¼ã€‚

**æ­¥é©Ÿ 3ï¼šç†è§£è¡¨æ ¼é—œè¯**

```
users (1) ----< (N) auth_tokens      # ä¸€å€‹ç”¨æˆ¶å¯ä»¥æœ‰å¤šå€‹ Token
users (1) ----< (N) coin_favorites   # ä¸€å€‹ç”¨æˆ¶å¯ä»¥æ”¶è—å¤šå€‹å¹£ç¨®
users (1) ----< (N) announcements    # ä¸€å€‹ç”¨æˆ¶ï¼ˆç®¡ç†å“¡ï¼‰å¯ä»¥å»ºç«‹å¤šå€‹å…¬å‘Š
```

#### å­¸ç¿’æª¢æŸ¥é»
- [ ] ç†è§£è³‡æ–™åº«æ­£è¦åŒ–çš„åŸºæœ¬æ¦‚å¿µ
- [ ] ç†è§£ä¸»éµå’Œå¤–éµçš„ä½œç”¨
- [ ] æˆåŠŸå»ºç«‹è³‡æ–™åº«ä¸¦é©—è­‰è¡¨æ ¼å­˜åœ¨
- [ ] ç†è§£å„è¡¨æ ¼ä¹‹é–“çš„é—œè¯é—œä¿‚

**Gemini æç¤º**ï¼š
- ç”¨åœ–è¡¨è§£é‡‹è¡¨æ ¼é—œè¯
- è§£é‡‹ç‚ºä»€éº¼éœ€è¦é€™æ¨£è¨­è¨ˆï¼ˆä¾‹å¦‚ï¼šç‚ºä»€éº¼éœ€è¦ auth_tokens è¡¨ï¼Ÿï¼‰
- ç¢ºèªå­¸ç¿’è€…ç†è§£ CASCADE DELETE çš„ä½œç”¨

---

## ğŸ”§ ç¬¬äºŒéšæ®µï¼šå¾Œç«¯åŸºç¤å»ºè¨­ï¼ˆç¬¬ 3-5 é€±ï¼‰

### Week 3ï¼šEntity å±¤èˆ‡ Repository å±¤

#### ç›®æ¨™
å»ºç«‹ JPA Entity é¡åˆ¥å’Œè³‡æ–™å­˜å–å±¤

#### Day 1-2ï¼šé…ç½®å¾Œç«¯åŸºç¤è¨­å®š

**æ­¥é©Ÿ 1ï¼šé…ç½® pom.xml**

ç·¨è¼¯ `backend/pom.xml`ï¼Œç¢ºä¿åŒ…å«ä»¥ä¸‹ä¾è³´ï¼š

```xml
<dependencies>
    <!-- Spring Boot Web -->
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-web</artifactId>
    </dependency>

    <!-- Spring Data JPA -->
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-data-jpa</artifactId>
    </dependency>

    <!-- Spring Security -->
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-security</artifactId>
    </dependency>

    <!-- MySQL Driver -->
    <dependency>
        <groupId>com.mysql</groupId>
        <artifactId>mysql-connector-j</artifactId>
        <scope>runtime</scope>
    </dependency>

    <!-- Lombok -->
    <dependency>
        <groupId>org.projectlombok</groupId>
        <artifactId>lombok</artifactId>
        <optional>true</optional>
    </dependency>

    <!-- JWT -->
    <dependency>
        <groupId>io.jsonwebtoken</groupId>
        <artifactId>jjwt-api</artifactId>
        <version>0.11.5</version>
    </dependency>
    <dependency>
        <groupId>io.jsonwebtoken</groupId>
        <artifactId>jjwt-impl</artifactId>
        <version>0.11.5</version>
        <scope>runtime</scope>
    </dependency>
    <dependency>
        <groupId>io.jsonwebtoken</groupId>
        <artifactId>jjwt-jackson</artifactId>
        <version>0.11.5</version>
        <scope>runtime</scope>
    </dependency>

    <!-- Caffeine Cache -->
    <dependency>
        <groupId>com.github.ben-manes.caffeine</groupId>
        <artifactId>caffeine</artifactId>
    </dependency>

    <!-- Swagger/OpenAPI -->
    <dependency>
        <groupId>org.springdoc</groupId>
        <artifactId>springdoc-openapi-starter-webmvc-ui</artifactId>
        <version>2.2.0</version>
    </dependency>

    <!-- Validation -->
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-validation</artifactId>
    </dependency>
</dependencies>
```

**æ­¥é©Ÿ 2ï¼šå»ºç«‹ application.yml**

å»ºç«‹ `backend/src/main/resources/application.yml`ï¼š

```yaml
spring:
  application:
    name: CoinVue Backend

  datasource:
    url: jdbc:mysql://localhost:3306/crypto_dashboard?useSSL=false&serverTimezone=UTC&allowPublicKeyRetrieval=true
    username: root
    password: your_mysql_password  # æ”¹æˆä½ çš„ MySQL å¯†ç¢¼
    driver-class-name: com.mysql.cj.jdbc.Driver

  jpa:
    hibernate:
      ddl-auto: validate  # ä¸è‡ªå‹•å»ºç«‹è¡¨æ ¼ï¼Œä½¿ç”¨å·²å­˜åœ¨çš„è³‡æ–™åº«çµæ§‹
    show-sql: true        # é¡¯ç¤º SQL èªå¥ï¼ˆé–‹ç™¼æ™‚æœ‰ç”¨ï¼‰
    properties:
      hibernate:
        format_sql: true
        dialect: org.hibernate.dialect.MySQL8Dialect

  cache:
    type: caffeine
    caffeine:
      spec: maximumSize=1000,expireAfterWrite=300s

server:
  port: 8080
  servlet:
    context-path: /api

# JWT é…ç½®
jwt:
  secret: coinvue-secret-key-minimum-32-characters-required-for-hs512
  expiration: 86400000  # 24 å°æ™‚ï¼ˆæ¯«ç§’ï¼‰

# CoinGecko API é…ç½®
coingecko:
  api:
    key: CG-vczvnvBTsqG7Z8EVB7KRb3ii
    base-url: https://api.coingecko.com/api/v3

# CORS é…ç½®
cors:
  allowed-origins: http://localhost:5173
  allowed-methods: GET,POST,PUT,DELETE,OPTIONS
  allowed-headers: "*"
  allow-credentials: true

# Logging
logging:
  level:
    com.crypto.dashboard: DEBUG
    org.hibernate.SQL: DEBUG
```

**æ­¥é©Ÿ 3ï¼šå»ºç«‹é–‹ç™¼ç’°å¢ƒé…ç½®**

å»ºç«‹ `backend/src/main/resources/application-dev.yml`ï¼š

```yaml
spring:
  datasource:
    password: your_mysql_password  # é–‹ç™¼ç’°å¢ƒçš„ MySQL å¯†ç¢¼

logging:
  level:
    root: INFO
    com.crypto.dashboard: DEBUG
```

#### Day 3-5ï¼šå»ºç«‹ Entity é¡åˆ¥

**å»ºç«‹è³‡æ–™å¤¾çµæ§‹**

```
backend/src/main/java/com/crypto/dashboard/
â”œâ”€â”€ entity/        # å¯¦é«”é¡åˆ¥
â”œâ”€â”€ repository/    # è³‡æ–™å­˜å–å±¤
â”œâ”€â”€ service/       # æ¥­å‹™é‚è¼¯å±¤
â”œâ”€â”€ controller/    # API æ§åˆ¶å™¨
â”œâ”€â”€ dto/           # è³‡æ–™å‚³è¼¸ç‰©ä»¶
â”œâ”€â”€ config/        # é…ç½®é¡åˆ¥
â”œâ”€â”€ exception/     # ä¾‹å¤–è™•ç†
â””â”€â”€ util/          # å·¥å…·é¡åˆ¥
```

**Entity 1: User.java**

å»ºç«‹ `backend/src/main/java/com/crypto/dashboard/entity/User.java`ï¼š

```java
package com.crypto.dashboard.entity;

import jakarta.persistence.*;
import lombok.Getter;
import lombok.Setter;
import java.time.LocalDateTime;

@Entity
@Table(name = "users")
@Getter
@Setter
public class User {

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    @Column(nullable = false, unique = true, length = 50)
    private String username;

    @Column(nullable = false, unique = true, length = 100)
    private String email;

    @Column(nullable = false, length = 255)
    private String password;

    @Enumerated(EnumType.STRING)
    @Column(nullable = false, length = 20)
    private UserRole role = UserRole.USER;

    @Enumerated(EnumType.STRING)
    @Column(nullable = false, length = 20)
    private UserStatus status = UserStatus.ACTIVE;

    @Column(name = "preferred_language", length = 10)
    private String preferredLanguage = "zh-TW";

    @Column(name = "join_date", nullable = false, updatable = false)
    private LocalDateTime joinDate = LocalDateTime.now();

    @Column(name = "last_login")
    private LocalDateTime lastLogin;

    // æšèˆ‰é¡å‹
    public enum UserRole {
        USER, ADMIN
    }

    public enum UserStatus {
        ACTIVE, INACTIVE, SUSPENDED
    }
}
```

**é‡é»è§£é‡‹**ï¼š
- `@Entity`ï¼šæ¨™è¨˜é€™æ˜¯ä¸€å€‹ JPA å¯¦é«”é¡åˆ¥ï¼Œæœƒå°æ‡‰åˆ°è³‡æ–™åº«çš„è¡¨æ ¼
- `@Table(name = "users")`ï¼šæŒ‡å®šå°æ‡‰çš„è¡¨æ ¼åç¨±
- `@Id`ï¼šæ¨™è¨˜ä¸»éµ
- `@GeneratedValue`ï¼šä¸»éµè‡ªå‹•ç”Ÿæˆç­–ç•¥
- `@Column`ï¼šå°æ‡‰è³‡æ–™åº«æ¬„ä½ï¼Œå¯è¨­å®šé™åˆ¶æ¢ä»¶
- `@Enumerated(EnumType.STRING)`ï¼šå°‡ enum ä»¥å­—ä¸²å½¢å¼å„²å­˜ï¼ˆè€Œéæ•´æ•¸ï¼‰
- `@Getter/@Setter`ï¼šLombok è‡ªå‹•ç”Ÿæˆ getter/setter æ–¹æ³•

**Entity 2: AuthToken.java**

å»ºç«‹ `backend/src/main/java/com/crypto/dashboard/entity/AuthToken.java`ï¼š

```java
package com.crypto.dashboard.entity;

import jakarta.persistence.*;
import lombok.Getter;
import lombok.Setter;
import java.time.LocalDateTime;

@Entity
@Table(name = "auth_tokens")
@Getter
@Setter
public class AuthToken {

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    @ManyToOne(fetch = FetchType.LAZY)
    @JoinColumn(name = "user_id", nullable = false)
    private User user;

    @Column(nullable = false, unique = true, length = 500)
    private String token;

    @Column(name = "created_at", nullable = false, updatable = false)
    private LocalDateTime createdAt = LocalDateTime.now();

    @Column(name = "expires_at", nullable = false)
    private LocalDateTime expiresAt;

    @Column(name = "is_valid", nullable = false)
    private Boolean isValid = true;
}
```

**é‡é»è§£é‡‹**ï¼š
- `@ManyToOne`ï¼šå¤šå°ä¸€é—œè¯ï¼ˆå¤šå€‹ Token å±¬æ–¼ä¸€å€‹ Userï¼‰
- `fetch = FetchType.LAZY`ï¼šå»¶é²è¼‰å…¥ï¼Œåªåœ¨éœ€è¦æ™‚æ‰æŸ¥è©¢é—œè¯çš„ User
- `@JoinColumn`ï¼šæŒ‡å®šå¤–éµæ¬„ä½

**Entity 3: CoinFavorite.java**

å»ºç«‹ `backend/src/main/java/com/crypto/dashboard/entity/CoinFavorite.java`ï¼š

```java
package com.crypto.dashboard.entity;

import jakarta.persistence.*;
import lombok.Getter;
import lombok.Setter;
import java.time.LocalDateTime;

@Entity
@Table(
    name = "coin_favorites",
    uniqueConstraints = @UniqueConstraint(
        columnNames = {"user_id", "coin_id"}
    )
)
@Getter
@Setter
public class CoinFavorite {

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    @ManyToOne(fetch = FetchType.LAZY)
    @JoinColumn(name = "user_id", nullable = false)
    private User user;

    @Column(name = "coin_id", nullable = false, length = 50)
    private String coinId;

    @Column(name = "added_at", nullable = false, updatable = false)
    private LocalDateTime addedAt = LocalDateTime.now();
}
```

**é‡é»è§£é‡‹**ï¼š
- `@UniqueConstraint`ï¼šç¢ºä¿ä¸€å€‹ç”¨æˆ¶ä¸æœƒé‡è¤‡æ”¶è—åŒä¸€å€‹å¹£ç¨®

**Entity 4: Announcement.java**

å»ºç«‹ `backend/src/main/java/com/crypto/dashboard/entity/Announcement.java`ï¼š

```java
package com.crypto.dashboard.entity;

import jakarta.persistence.*;
import lombok.Getter;
import lombok.Setter;
import java.time.LocalDateTime;

@Entity
@Table(name = "announcements")
@Getter
@Setter
public class Announcement {

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    @Column(nullable = false, length = 200)
    private String title;

    @Column(nullable = false, columnDefinition = "TEXT")
    private String content;

    @Enumerated(EnumType.STRING)
    @Column(nullable = false, length = 20)
    private AnnouncementType type = AnnouncementType.INFO;

    @Column(name = "is_active", nullable = false)
    private Boolean isActive = true;

    @ManyToOne(fetch = FetchType.LAZY)
    @JoinColumn(name = "created_by", nullable = false)
    private User createdBy;

    @Column(name = "created_at", nullable = false, updatable = false)
    private LocalDateTime createdAt = LocalDateTime.now();

    @Column(name = "updated_at")
    private LocalDateTime updatedAt = LocalDateTime.now();

    // æšèˆ‰é¡å‹
    public enum AnnouncementType {
        INFO, SUCCESS, WARNING
    }

    @PreUpdate
    protected void onUpdate() {
        updatedAt = LocalDateTime.now();
    }
}
```

**é‡é»è§£é‡‹**ï¼š
- `@PreUpdate`ï¼šJPA ç”Ÿå‘½é€±æœŸå›èª¿ï¼Œåœ¨æ›´æ–°å‰è‡ªå‹•åŸ·è¡Œ

#### Day 6-7ï¼šå»ºç«‹ Repository å±¤

**Repository 1: UserRepository.java**

å»ºç«‹ `backend/src/main/java/com/crypto/dashboard/repository/UserRepository.java`ï¼š

```java
package com.crypto.dashboard.repository;

import com.crypto.dashboard.entity.User;
import org.springframework.data.jpa.repository.JpaRepository;
import org.springframework.data.jpa.repository.Query;
import org.springframework.stereotype.Repository;

import java.time.LocalDateTime;
import java.util.Optional;

@Repository
public interface UserRepository extends JpaRepository<User, Long> {

    // æ ¹æ“š email æŸ¥è©¢ç”¨æˆ¶
    Optional<User> findByEmail(String email);

    // æ ¹æ“š username æŸ¥è©¢ç”¨æˆ¶
    Optional<User> findByUsername(String username);

    // æª¢æŸ¥ email æ˜¯å¦å·²å­˜åœ¨
    boolean existsByEmail(String email);

    // æª¢æŸ¥ username æ˜¯å¦å·²å­˜åœ¨
    boolean existsByUsername(String username);

    // æŸ¥è©¢æ´»èºç”¨æˆ¶æ•¸ï¼ˆ7å¤©å…§ç™»å…¥ï¼‰
    @Query("SELECT COUNT(u) FROM User u WHERE u.lastLogin >= :since")
    long countActiveUsers(LocalDateTime since);

    // æŸ¥è©¢æ‰€æœ‰ç”¨æˆ¶ï¼ˆå«æ”¶è—æ•¸çµ±è¨ˆï¼‰
    @Query("SELECT u, COUNT(f.id) as favoriteCount " +
           "FROM User u LEFT JOIN CoinFavorite f ON u.id = f.user.id " +
           "GROUP BY u.id")
    Object[][] findAllWithFavoriteCount();
}
```

**é‡é»è§£é‡‹**ï¼š
- `JpaRepository<User, Long>`ï¼šç¹¼æ‰¿ JPA çš„åŸºç¤ Repositoryï¼Œæä¾›åŸºæœ¬ CRUD æ–¹æ³•
  - `User`ï¼šå¯¦é«”é¡å‹
  - `Long`ï¼šä¸»éµé¡å‹
- Spring Data JPA æœƒæ ¹æ“šæ–¹æ³•åè‡ªå‹•ç”Ÿæˆ SQLï¼ˆå¦‚ `findByEmail`ï¼‰
- `@Query`ï¼šè‡ªè¨‚ JPQL æŸ¥è©¢èªå¥

**Repository 2: AuthTokenRepository.java**

å»ºç«‹ `backend/src/main/java/com/crypto/dashboard/repository/AuthTokenRepository.java`ï¼š

```java
package com.crypto.dashboard.repository;

import com.crypto.dashboard.entity.AuthToken;
import com.crypto.dashboard.entity.User;
import org.springframework.data.jpa.repository.JpaRepository;
import org.springframework.data.jpa.repository.Modifying;
import org.springframework.data.jpa.repository.Query;
import org.springframework.stereotype.Repository;
import org.springframework.transaction.annotation.Transactional;

import java.time.LocalDateTime;
import java.util.Optional;

@Repository
public interface AuthTokenRepository extends JpaRepository<AuthToken, Long> {

    // æ ¹æ“š token å­—ä¸²æŸ¥è©¢
    Optional<AuthToken> findByToken(String token);

    // åˆªé™¤ç”¨æˆ¶çš„æ‰€æœ‰ Token
    @Modifying
    @Transactional
    void deleteByUser_Id(Long userId);

    // åˆªé™¤å·²éæœŸçš„ Token
    @Modifying
    @Transactional
    @Query("DELETE FROM AuthToken a WHERE a.expiresAt < :now")
    void deleteExpiredTokens(LocalDateTime now);
}
```

**é‡é»è§£é‡‹**ï¼š
- `@Modifying`ï¼šæ¨™è¨˜é€™æ˜¯ä¸€å€‹ä¿®æ”¹æ“ä½œï¼ˆINSERTã€UPDATEã€DELETEï¼‰
- `@Transactional`ï¼šé–‹å•Ÿäº¤æ˜“ç®¡ç†ï¼Œç¢ºä¿è³‡æ–™ä¸€è‡´æ€§
- `deleteByUser_Id`ï¼šæ ¹æ“šé—œè¯å¯¦é«”çš„å±¬æ€§åˆªé™¤ï¼ˆæ³¨æ„æ˜¯ `User_Id`ï¼Œä¸æ˜¯ `UserId`ï¼‰

**Repository 3: CoinFavoriteRepository.java**

å»ºç«‹ `backend/src/main/java/com/crypto/dashboard/repository/CoinFavoriteRepository.java`ï¼š

```java
package com.crypto.dashboard.repository;

import com.crypto.dashboard.entity.CoinFavorite;
import org.springframework.data.jpa.repository.JpaRepository;
import org.springframework.data.jpa.repository.Modifying;
import org.springframework.data.jpa.repository.Query;
import org.springframework.stereotype.Repository;
import org.springframework.transaction.annotation.Transactional;

import java.util.List;
import java.util.Optional;

@Repository
public interface CoinFavoriteRepository extends JpaRepository<CoinFavorite, Long> {

    // æŸ¥è©¢ç”¨æˆ¶çš„æ‰€æœ‰æ”¶è—
    List<CoinFavorite> findByUser_Id(Long userId);

    // æŸ¥è©¢ç”¨æˆ¶æ˜¯å¦å·²æ”¶è—æŸå¹£ç¨®
    Optional<CoinFavorite> findByUser_IdAndCoinId(Long userId, String coinId);

    // æª¢æŸ¥ç”¨æˆ¶æ˜¯å¦å·²æ”¶è—æŸå¹£ç¨®
    boolean existsByUser_IdAndCoinId(Long userId, String coinId);

    // åˆªé™¤ç”¨æˆ¶çš„æŸå€‹æ”¶è—
    @Modifying
    @Transactional
    void deleteByUser_IdAndCoinId(Long userId, String coinId);

    // åˆªé™¤ç”¨æˆ¶çš„æ‰€æœ‰æ”¶è—
    @Modifying
    @Transactional
    void deleteByUser_Id(Long userId);

    // æŸ¥è©¢ç¸½æ”¶è—æ•¸
    @Query("SELECT COUNT(f) FROM CoinFavorite f")
    long countAllFavorites();

    // æŸ¥è©¢æœ€å¤šæ”¶è—çš„å¹£ç¨®æ’è¡Œï¼ˆä½¿ç”¨åŸç”Ÿ SQLï¼‰
    @Query(value = "SELECT coin_id, COUNT(*) as count " +
                   "FROM coin_favorites " +
                   "GROUP BY coin_id " +
                   "ORDER BY count DESC " +
                   "LIMIT ?1",
           nativeQuery = true)
    List<Object[]> findTopFavoriteCoins(int limit);
}
```

**é‡é»è§£é‡‹**ï¼š
- `nativeQuery = true`ï¼šä½¿ç”¨åŸç”Ÿ SQLï¼ˆå› ç‚º JPQL ä¸æ”¯æ´ LIMIT èªæ³•ï¼‰

**Repository 4: AnnouncementRepository.java**

å»ºç«‹ `backend/src/main/java/com/crypto/dashboard/repository/AnnouncementRepository.java`ï¼š

```java
package com.crypto.dashboard.repository;

import com.crypto.dashboard.entity.Announcement;
import org.springframework.data.jpa.repository.JpaRepository;
import org.springframework.stereotype.Repository;

import java.util.List;

@Repository
public interface AnnouncementRepository extends JpaRepository<Announcement, Long> {

    // æŸ¥è©¢æ‰€æœ‰å•Ÿç”¨çš„å…¬å‘Šï¼ˆæŒ‰å»ºç«‹æ™‚é–“é™åºï¼‰
    List<Announcement> findByIsActiveTrueOrderByCreatedAtDesc();

    // æŸ¥è©¢æ‰€æœ‰å…¬å‘Šï¼ˆæŒ‰å»ºç«‹æ™‚é–“é™åºï¼‰
    List<Announcement> findAllByOrderByCreatedAtDesc();
}
```

#### å­¸ç¿’æª¢æŸ¥é»
- [ ] ç†è§£ JPA Entity çš„è¨»è§£ç”¨æ³•
- [ ] ç†è§£ JPA Repository çš„æ–¹æ³•å‘½åè¦å‰‡
- [ ] æˆåŠŸå»ºç«‹ 4 å€‹ Entity å’Œ 4 å€‹ Repository
- [ ] ç†è§£ `@ManyToOne` é—œè¯çš„ä½œç”¨

**Gemini æç¤º**ï¼š
- è§£é‡‹ç‚ºä»€éº¼ä½¿ç”¨ `FetchType.LAZY` è€Œä¸æ˜¯ `EAGER`
- è§£é‡‹ `@Modifying` å’Œ `@Transactional` çš„é‡è¦æ€§
- ç¢ºèªå­¸ç¿’è€…ç†è§£ Repository æ–¹æ³•å‘½åè¦å‰‡ï¼ˆå¦‚ `findByUser_Id`ï¼‰

---

### Week 4ï¼šService å±¤èˆ‡ JWT èªè­‰

#### ç›®æ¨™
å¯¦ä½œæ¥­å‹™é‚è¼¯å±¤å’Œ JWT èªè­‰ç³»çµ±

#### Day 1-2ï¼šå»ºç«‹ JWT å·¥å…·é¡

**æ­¥é©Ÿ 1ï¼šå»ºç«‹ JwtUtil.java**

å»ºç«‹ `backend/src/main/java/com/crypto/dashboard/util/JwtUtil.java`ï¼š

```java
package com.crypto.dashboard.util;

import io.jsonwebtoken.*;
import io.jsonwebtoken.security.Keys;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.stereotype.Component;

import java.security.Key;
import java.util.Date;

@Component
public class JwtUtil {

    @Value("${jwt.secret}")
    private String secret;

    @Value("${jwt.expiration}")
    private Long expiration;

    // ç”Ÿæˆ JWT Token
    public String generateToken(Long userId, String role) {
        Date now = new Date();
        Date expiryDate = new Date(now.getTime() + expiration);

        return Jwts.builder()
                .setSubject(userId.toString())
                .claim("role", role)
                .setIssuedAt(now)
                .setExpiration(expiryDate)
                .signWith(getSigningKey(), SignatureAlgorithm.HS512)
                .compact();
    }

    // å¾ Token å–å¾— User ID
    public Long getUserIdFromToken(String token) {
        Claims claims = Jwts.parserBuilder()
                .setSigningKey(getSigningKey())
                .build()
                .parseClaimsJws(token)
                .getBody();

        return Long.parseLong(claims.getSubject());
    }

    // å¾ Token å–å¾—è§’è‰²
    public String getRoleFromToken(String token) {
        Claims claims = Jwts.parserBuilder()
                .setSigningKey(getSigningKey())
                .build()
                .parseClaimsJws(token)
                .getBody();

        return claims.get("role", String.class);
    }

    // é©—è­‰ Token æ˜¯å¦æœ‰æ•ˆ
    public boolean validateToken(String token) {
        try {
            Jwts.parserBuilder()
                .setSigningKey(getSigningKey())
                .build()
                .parseClaimsJws(token);
            return true;
        } catch (JwtException | IllegalArgumentException e) {
            return false;
        }
    }

    // å–å¾—ç°½åå¯†é‘°
    private Key getSigningKey() {
        byte[] keyBytes = secret.getBytes();
        return Keys.hmacShaKeyFor(keyBytes);
    }
}
```

**é‡é»è§£é‡‹**ï¼š
- `@Component`ï¼šå°‡é¡åˆ¥è¨»å†Šç‚º Spring Beanï¼Œå¯è¢«æ³¨å…¥åˆ°å…¶ä»–é¡åˆ¥
- `@Value`ï¼šå¾ application.yml è®€å–é…ç½®
- `setSubject()`ï¼šè¨­å®š JWT çš„ä¸»é«”ï¼ˆé€šå¸¸æ˜¯ç”¨æˆ¶ IDï¼‰
- `claim()`ï¼šæ·»åŠ è‡ªè¨‚æ¬„ä½ï¼ˆå¦‚è§’è‰²ï¼‰
- `SignatureAlgorithm.HS512`ï¼šä½¿ç”¨ HMAC-SHA512 æ¼”ç®—æ³•ç°½å

#### Day 3-4ï¼šå»ºç«‹ DTO é¡åˆ¥

**DTO 1: ç™»å…¥è«‹æ±‚**

å»ºç«‹ `backend/src/main/java/com/crypto/dashboard/dto/LoginRequest.java`ï¼š

```java
package com.crypto.dashboard.dto;

import jakarta.validation.constraints.Email;
import jakarta.validation.constraints.NotBlank;
import lombok.Data;

@Data
public class LoginRequest {

    @NotBlank(message = "Email ä¸èƒ½ç‚ºç©º")
    @Email(message = "Email æ ¼å¼ä¸æ­£ç¢º")
    private String email;

    @NotBlank(message = "å¯†ç¢¼ä¸èƒ½ç‚ºç©º")
    private String password;
}
```

**é‡é»è§£é‡‹**ï¼š
- `@Data`ï¼šLombok è‡ªå‹•ç”Ÿæˆ getterã€setterã€toString ç­‰æ–¹æ³•
- `@NotBlank`ï¼šé©—è­‰æ¬„ä½ä¸èƒ½ç‚ºç©º
- `@Email`ï¼šé©—è­‰ Email æ ¼å¼

**DTO 2: è¨»å†Šè«‹æ±‚**

å»ºç«‹ `backend/src/main/java/com/crypto/dashboard/dto/RegisterRequest.java`ï¼š

```java
package com.crypto.dashboard.dto;

import jakarta.validation.constraints.Email;
import jakarta.validation.constraints.NotBlank;
import jakarta.validation.constraints.Size;
import lombok.Data;

@Data
public class RegisterRequest {

    @NotBlank(message = "ç”¨æˆ¶åä¸èƒ½ç‚ºç©º")
    @Size(min = 3, max = 50, message = "ç”¨æˆ¶åé•·åº¦å¿…é ˆåœ¨ 3-50 å­—å…ƒä¹‹é–“")
    private String username;

    @NotBlank(message = "Email ä¸èƒ½ç‚ºç©º")
    @Email(message = "Email æ ¼å¼ä¸æ­£ç¢º")
    private String email;

    @NotBlank(message = "å¯†ç¢¼ä¸èƒ½ç‚ºç©º")
    @Size(min = 6, max = 100, message = "å¯†ç¢¼é•·åº¦å¿…é ˆåœ¨ 6-100 å­—å…ƒä¹‹é–“")
    private String password;
}
```

**DTO 3: èªè­‰å›æ‡‰**

å»ºç«‹ `backend/src/main/java/com/crypto/dashboard/dto/AuthResponse.java`ï¼š

```java
package com.crypto.dashboard.dto;

import lombok.AllArgsConstructor;
import lombok.Data;

@Data
@AllArgsConstructor
public class AuthResponse {
    private String token;
    private UserDTO user;

    @Data
    @AllArgsConstructor
    public static class UserDTO {
        private Long id;
        private String username;
        private String email;
        private String role;
        private String status;
    }
}
```

#### Day 5-7ï¼šå»ºç«‹ Service å±¤

**Service 1: AuthService.java**

å»ºç«‹ `backend/src/main/java/com/crypto/dashboard/service/AuthService.java`ï¼š

```java
package com.crypto.dashboard.service;

import com.crypto.dashboard.dto.AuthResponse;
import com.crypto.dashboard.dto.LoginRequest;
import com.crypto.dashboard.dto.RegisterRequest;
import com.crypto.dashboard.entity.AuthToken;
import com.crypto.dashboard.entity.User;
import com.crypto.dashboard.exception.DuplicateUserException;
import com.crypto.dashboard.exception.InvalidCredentialsException;
import com.crypto.dashboard.repository.AuthTokenRepository;
import com.crypto.dashboard.repository.UserRepository;
import com.crypto.dashboard.util.JwtUtil;
import lombok.RequiredArgsConstructor;
import org.springframework.security.crypto.password.PasswordEncoder;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;

import java.time.LocalDateTime;

@Service
@RequiredArgsConstructor
public class AuthService {

    private final UserRepository userRepository;
    private final AuthTokenRepository authTokenRepository;
    private final PasswordEncoder passwordEncoder;
    private final JwtUtil jwtUtil;

    // ç”¨æˆ¶è¨»å†Š
    @Transactional
    public AuthResponse register(RegisterRequest request) {
        // æª¢æŸ¥ email æ˜¯å¦å·²å­˜åœ¨
        if (userRepository.existsByEmail(request.getEmail())) {
            throw new DuplicateUserException("Email å·²è¢«è¨»å†Š");
        }

        // æª¢æŸ¥ username æ˜¯å¦å·²å­˜åœ¨
        if (userRepository.existsByUsername(request.getUsername())) {
            throw new DuplicateUserException("ç”¨æˆ¶åå·²è¢«ä½¿ç”¨");
        }

        // å»ºç«‹æ–°ç”¨æˆ¶
        User user = new User();
        user.setUsername(request.getUsername());
        user.setEmail(request.getEmail());
        user.setPassword(passwordEncoder.encode(request.getPassword()));
        user.setRole(User.UserRole.USER);  // é è¨­è§’è‰²ç‚º USER
        user.setStatus(User.UserStatus.ACTIVE);

        user = userRepository.save(user);

        // ç°½ç™¼ JWT Token
        return issueToken(user);
    }

    // ç”¨æˆ¶ç™»å…¥
    @Transactional
    public AuthResponse login(LoginRequest request) {
        // æŸ¥è©¢ç”¨æˆ¶
        User user = userRepository.findByEmail(request.getEmail())
                .orElseThrow(() -> new InvalidCredentialsException("Email æˆ–å¯†ç¢¼éŒ¯èª¤"));

        // é©—è­‰å¯†ç¢¼
        if (!passwordEncoder.matches(request.getPassword(), user.getPassword())) {
            throw new InvalidCredentialsException("Email æˆ–å¯†ç¢¼éŒ¯èª¤");
        }

        // æ›´æ–°æœ€å¾Œç™»å…¥æ™‚é–“
        user.setLastLogin(LocalDateTime.now());
        userRepository.save(user);

        // åˆªé™¤èˆŠ Tokenï¼ˆå¯é¸ï¼‰
        authTokenRepository.deleteByUser_Id(user.getId());

        // ç°½ç™¼ JWT Token
        return issueToken(user);
    }

    // ç”¨æˆ¶ç™»å‡º
    @Transactional
    public void logout(String token) {
        authTokenRepository.findByToken(token)
                .ifPresent(authTokenRepository::delete);
    }

    // ç°½ç™¼ Tokenï¼ˆç§æœ‰æ–¹æ³•ï¼‰
    private AuthResponse issueToken(User user) {
        // ç”Ÿæˆ JWT
        String token = jwtUtil.generateToken(user.getId(), user.getRole().name());

        // å„²å­˜åˆ°è³‡æ–™åº«
        AuthToken authToken = new AuthToken();
        authToken.setUser(user);
        authToken.setToken(token);
        authToken.setExpiresAt(LocalDateTime.now().plusDays(1));
        authTokenRepository.save(authToken);

        // è¿”å›å›æ‡‰
        return new AuthResponse(
            token,
            new AuthResponse.UserDTO(
                user.getId(),
                user.getUsername(),
                user.getEmail(),
                user.getRole().name().toLowerCase(),
                user.getStatus().name().toLowerCase()
            )
        );
    }
}
```

**é‡é»è§£é‡‹**ï¼š
- `@Service`ï¼šæ¨™è¨˜ç‚ºæ¥­å‹™é‚è¼¯å±¤
- `@RequiredArgsConstructor`ï¼šLombok è‡ªå‹•ç”ŸæˆåŒ…å«æ‰€æœ‰ final æ¬„ä½çš„å»ºæ§‹å­ï¼ˆå¯¦ç¾ä¾è³´æ³¨å…¥ï¼‰
- `@Transactional`ï¼šé–‹å•Ÿäº¤æ˜“ç®¡ç†
- `passwordEncoder.encode()`ï¼šä½¿ç”¨ BCrypt åŠ å¯†å¯†ç¢¼
- `passwordEncoder.matches()`ï¼šé©—è­‰å¯†ç¢¼

**Service 2: FavoriteService.java**

å»ºç«‹ `backend/src/main/java/com/crypto/dashboard/service/FavoriteService.java`ï¼š

```java
package com.crypto.dashboard.service;

import com.crypto.dashboard.entity.CoinFavorite;
import com.crypto.dashboard.entity.User;
import com.crypto.dashboard.exception.DuplicateFavoriteException;
import com.crypto.dashboard.exception.ResourceNotFoundException;
import com.crypto.dashboard.repository.CoinFavoriteRepository;
import com.crypto.dashboard.repository.UserRepository;
import lombok.RequiredArgsConstructor;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;

import java.util.List;
import java.util.stream.Collectors;

@Service
@RequiredArgsConstructor
public class FavoriteService {

    private final CoinFavoriteRepository coinFavoriteRepository;
    private final UserRepository userRepository;

    // å–å¾—ç”¨æˆ¶çš„æ‰€æœ‰æ”¶è—
    public List<String> getFavorites(Long userId) {
        return coinFavoriteRepository.findByUser_Id(userId)
                .stream()
                .map(CoinFavorite::getCoinId)
                .collect(Collectors.toList());
    }

    // æ–°å¢æ”¶è—
    @Transactional
    public void addFavorite(Long userId, String coinId) {
        // æª¢æŸ¥æ˜¯å¦å·²æ”¶è—
        if (coinFavoriteRepository.existsByUser_IdAndCoinId(userId, coinId)) {
            throw new DuplicateFavoriteException("å·²ç¶“æ”¶è—éæ­¤å¹£ç¨®");
        }

        // å¾è³‡æ–™åº«è¼‰å…¥ User å¯¦é«”
        User user = userRepository.findById(userId)
                .orElseThrow(() -> new ResourceNotFoundException("ç”¨æˆ¶ä¸å­˜åœ¨"));

        // å»ºç«‹æ”¶è—è¨˜éŒ„
        CoinFavorite favorite = new CoinFavorite();
        favorite.setUser(user);
        favorite.setCoinId(coinId);

        coinFavoriteRepository.save(favorite);
    }

    // ç§»é™¤æ”¶è—
    @Transactional
    public void removeFavorite(Long userId, String coinId) {
        if (!coinFavoriteRepository.existsByUser_IdAndCoinId(userId, coinId)) {
            throw new ResourceNotFoundException("æ”¶è—ä¸å­˜åœ¨");
        }

        coinFavoriteRepository.deleteByUser_IdAndCoinId(userId, coinId);
    }

    // æ¸…ç©ºæ‰€æœ‰æ”¶è—
    @Transactional
    public void clearFavorites(Long userId) {
        coinFavoriteRepository.deleteByUser_Id(userId);
    }
}
```

#### å­¸ç¿’æª¢æŸ¥é»
- [ ] ç†è§£ JWT çš„ç”Ÿæˆå’Œé©—è­‰æµç¨‹
- [ ] ç†è§£ DTO çš„ä½œç”¨ï¼ˆè³‡æ–™å‚³è¼¸ç‰©ä»¶ï¼‰
- [ ] ç†è§£ Service å±¤çš„è·è²¬ï¼ˆæ¥­å‹™é‚è¼¯ï¼‰
- [ ] ç†è§£å¯†ç¢¼åŠ å¯†çš„é‡è¦æ€§

**Gemini æç¤º**ï¼š
- è§£é‡‹ç‚ºä»€éº¼ä¸èƒ½ç›´æ¥å‚³è¼¸ Entityï¼Œè€Œè¦ä½¿ç”¨ DTO
- è§£é‡‹ç‚ºä»€éº¼éœ€è¦ `@Transactional`
- è§£é‡‹ BCrypt åŠ å¯†çš„åŸç†

---

---

### Week 5ï¼šController å±¤èˆ‡ Security é…ç½®

#### ç›®æ¨™
å¯¦ä½œ REST API æ§åˆ¶å™¨å’Œ Spring Security é…ç½®

#### Day 1-2ï¼šå»ºç«‹ä¾‹å¤–è™•ç†

**æ­¥é©Ÿ 1ï¼šå»ºç«‹è‡ªè¨‚ä¾‹å¤–é¡åˆ¥**

å»ºç«‹ `backend/src/main/java/com/crypto/dashboard/exception/` è³‡æ–™å¤¾ï¼Œä¸¦å»ºç«‹ä»¥ä¸‹ä¾‹å¤–é¡åˆ¥ï¼š

```java
// ResourceNotFoundException.java
package com.crypto.dashboard.exception;

public class ResourceNotFoundException extends RuntimeException {
    public ResourceNotFoundException(String message) {
        super(message);
    }
}

// DuplicateUserException.java
package com.crypto.dashboard.exception;

public class DuplicateUserException extends RuntimeException {
    public DuplicateUserException(String message) {
        super(message);
    }
}

// InvalidCredentialsException.java
package com.crypto.dashboard.exception;

public class InvalidCredentialsException extends RuntimeException {
    public InvalidCredentialsException(String message) {
        super(message);
    }
}

// DuplicateFavoriteException.java
package com.crypto.dashboard.exception;

public class DuplicateFavoriteException extends RuntimeException {
    public DuplicateFavoriteException(String message) {
        super(message);
    }
}
```

**æ­¥é©Ÿ 2ï¼šå»ºç«‹å…¨åŸŸä¾‹å¤–è™•ç†å™¨**

å»ºç«‹ `backend/src/main/java/com/crypto/dashboard/exception/GlobalExceptionHandler.java`ï¼š

```java
package com.crypto.dashboard.exception;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;
import org.springframework.validation.FieldError;
import org.springframework.web.bind.MethodArgumentNotValidException;
import org.springframework.web.bind.annotation.ExceptionHandler;
import org.springframework.web.bind.annotation.RestControllerAdvice;

import java.util.HashMap;
import java.util.Map;

@RestControllerAdvice
public class GlobalExceptionHandler {

    private static final Logger logger = LoggerFactory.getLogger(GlobalExceptionHandler.class);

    // è™•ç†é©—è­‰éŒ¯èª¤
    @ExceptionHandler(MethodArgumentNotValidException.class)
    public ResponseEntity<Map<String, String>> handleValidationExceptions(
            MethodArgumentNotValidException ex) {
        Map<String, String> errors = new HashMap<>();
        ex.getBindingResult().getAllErrors().forEach((error) -> {
            String fieldName = ((FieldError) error).getField();
            String errorMessage = error.getDefaultMessage();
            errors.put(fieldName, errorMessage);
        });
        return ResponseEntity.status(HttpStatus.BAD_REQUEST).body(errors);
    }

    // è™•ç†è³‡æºæœªæ‰¾åˆ°
    @ExceptionHandler(ResourceNotFoundException.class)
    public ResponseEntity<Map<String, String>> handleResourceNotFoundException(
            ResourceNotFoundException ex) {
        logger.warn("Resource not found: {}", ex.getMessage());
        return ResponseEntity.status(HttpStatus.NOT_FOUND)
                .body(Map.of("error", ex.getMessage()));
    }

    // è™•ç†é‡è¤‡ç”¨æˆ¶
    @ExceptionHandler(DuplicateUserException.class)
    public ResponseEntity<Map<String, String>> handleDuplicateUserException(
            DuplicateUserException ex) {
        logger.warn("Duplicate user: {}", ex.getMessage());
        return ResponseEntity.status(HttpStatus.CONFLICT)
                .body(Map.of("error", ex.getMessage()));
    }

    // è™•ç†èªè­‰éŒ¯èª¤
    @ExceptionHandler(InvalidCredentialsException.class)
    public ResponseEntity<Map<String, String>> handleInvalidCredentialsException(
            InvalidCredentialsException ex) {
        logger.warn("Invalid credentials: {}", ex.getMessage());
        return ResponseEntity.status(HttpStatus.UNAUTHORIZED)
                .body(Map.of("error", ex.getMessage()));
    }

    // è™•ç†é‡è¤‡æ”¶è—
    @ExceptionHandler(DuplicateFavoriteException.class)
    public ResponseEntity<Map<String, String>> handleDuplicateFavoriteException(
            DuplicateFavoriteException ex) {
        logger.warn("Duplicate favorite: {}", ex.getMessage());
        return ResponseEntity.status(HttpStatus.CONFLICT)
                .body(Map.of("error", ex.getMessage()));
    }

    // è™•ç†å…¶ä»–æœªæ•ç²çš„ä¾‹å¤–
    @ExceptionHandler(Exception.class)
    public ResponseEntity<Map<String, String>> handleGenericException(Exception ex) {
        logger.error("Unexpected error occurred", ex);
        return ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR)
                .body(Map.of("error", "ä¼ºæœå™¨ç™¼ç”ŸéŒ¯èª¤ï¼Œè«‹ç¨å¾Œå†è©¦"));
    }
}
```

#### Day 3-4ï¼šå»ºç«‹ Controller å±¤

**Controller 1: AuthController.java**

å»ºç«‹ `backend/src/main/java/com/crypto/dashboard/controller/AuthController.java`ï¼š

```java
package com.crypto.dashboard.controller;

import com.crypto.dashboard.dto.AuthResponse;
import com.crypto.dashboard.dto.LoginRequest;
import com.crypto.dashboard.dto.RegisterRequest;
import com.crypto.dashboard.service.AuthService;
import jakarta.validation.Valid;
import lombok.RequiredArgsConstructor;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.*;

@RestController
@RequestMapping("/auth")
@RequiredArgsConstructor
public class AuthController {

    private final AuthService authService;

    @PostMapping("/register")
    public ResponseEntity<AuthResponse> register(@Valid @RequestBody RegisterRequest request) {
        AuthResponse response = authService.register(request);
        return ResponseEntity.ok(response);
    }

    @PostMapping("/login")
    public ResponseEntity<AuthResponse> login(@Valid @RequestBody LoginRequest request) {
        AuthResponse response = authService.login(request);
        return ResponseEntity.ok(response);
    }

    @PostMapping("/logout")
    public ResponseEntity<Void> logout(@RequestHeader("Authorization") String authHeader) {
        String token = authHeader.replace("Bearer ", "");
        authService.logout(token);
        return ResponseEntity.ok().build();
    }
}
```

**Controller 2: FavoriteController.java**

å»ºç«‹ `backend/src/main/java/com/crypto/dashboard/controller/FavoriteController.java`ï¼š

```java
package com.crypto.dashboard.controller;

import com.crypto.dashboard.service.FavoriteService;
import lombok.RequiredArgsConstructor;
import org.springframework.http.ResponseEntity;
import org.springframework.security.core.Authentication;
import org.springframework.web.bind.annotation.*;

import java.util.List;

@RestController
@RequestMapping("/favorites")
@RequiredArgsConstructor
public class FavoriteController {

    private final FavoriteService favoriteService;

    @GetMapping
    public ResponseEntity<List<String>> getFavorites(Authentication authentication) {
        Long userId = Long.parseLong(authentication.getName());
        List<String> favorites = favoriteService.getFavorites(userId);
        return ResponseEntity.ok(favorites);
    }

    @PostMapping
    public ResponseEntity<Void> addFavorite(
            @RequestParam String coinId,
            Authentication authentication) {
        Long userId = Long.parseLong(authentication.getName());
        favoriteService.addFavorite(userId, coinId);
        return ResponseEntity.ok().build();
    }

    @DeleteMapping("/{coinId}")
    public ResponseEntity<Void> removeFavorite(
            @PathVariable String coinId,
            Authentication authentication) {
        Long userId = Long.parseLong(authentication.getName());
        favoriteService.removeFavorite(userId, coinId);
        return ResponseEntity.ok().build();
    }

    @DeleteMapping("/all")
    public ResponseEntity<Void> clearFavorites(Authentication authentication) {
        Long userId = Long.parseLong(authentication.getName());
        favoriteService.clearFavorites(userId);
        return ResponseEntity.ok().build();
    }
}
```

#### Day 5-7ï¼šSpring Security é…ç½®

**æ­¥é©Ÿ 1ï¼šå»ºç«‹ JWT éæ¿¾å™¨**

å»ºç«‹ `backend/src/main/java/com/crypto/dashboard/config/JwtAuthenticationFilter.java`ï¼š

```java
package com.crypto.dashboard.config;

import com.crypto.dashboard.util.JwtUtil;
import jakarta.servlet.FilterChain;
import jakarta.servlet.ServletException;
import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;
import lombok.RequiredArgsConstructor;
import org.springframework.security.authentication.UsernamePasswordAuthenticationToken;
import org.springframework.security.core.authority.SimpleGrantedAuthority;
import org.springframework.security.core.context.SecurityContextHolder;
import org.springframework.stereotype.Component;
import org.springframework.web.filter.OncePerRequestFilter;

import java.io.IOException;
import java.util.List;

@Component
@RequiredArgsConstructor
public class JwtAuthenticationFilter extends OncePerRequestFilter {

    private final JwtUtil jwtUtil;

    @Override
    protected void doFilterInternal(HttpServletRequest request,
                                    HttpServletResponse response,
                                    FilterChain filterChain)
            throws ServletException, IOException {

        String authHeader = request.getHeader("Authorization");

        if (authHeader != null && authHeader.startsWith("Bearer ")) {
            String token = authHeader.substring(7);

            if (jwtUtil.validateToken(token)) {
                Long userId = jwtUtil.getUserIdFromToken(token);
                String role = jwtUtil.getRoleFromToken(token);

                // è¨­å®šæ¬Šé™
                List<SimpleGrantedAuthority> authorities =
                    List.of(new SimpleGrantedAuthority("ROLE_" + role));

                // å»ºç«‹èªè­‰ç‰©ä»¶
                UsernamePasswordAuthenticationToken authentication =
                    new UsernamePasswordAuthenticationToken(userId, null, authorities);

                SecurityContextHolder.getContext().setAuthentication(authentication);
            }
        }

        filterChain.doFilter(request, response);
    }
}
```

**æ­¥é©Ÿ 2ï¼šå»ºç«‹ Security é…ç½®**

å»ºç«‹ `backend/src/main/java/com/crypto/dashboard/config/SecurityConfig.java`ï¼š

```java
package com.crypto.dashboard.config;

import lombok.RequiredArgsConstructor;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;
import org.springframework.security.config.http.SessionCreationPolicy;
import org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;
import org.springframework.security.crypto.password.PasswordEncoder;
import org.springframework.security.web.SecurityFilterChain;
import org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter;

@Configuration
@EnableWebSecurity
@RequiredArgsConstructor
public class SecurityConfig {

    private final JwtAuthenticationFilter jwtAuthenticationFilter;

    @Bean
    public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {
        http
            .csrf(csrf -> csrf.disable())
            .cors(cors -> {})
            .sessionManagement(session ->
                session.sessionCreationPolicy(SessionCreationPolicy.STATELESS))
            .authorizeHttpRequests(auth -> auth
                .requestMatchers("/auth/**", "/coins/**", "/swagger-ui/**", "/v3/api-docs/**").permitAll()
                .requestMatchers("/admin/**").hasRole("ADMIN")
                .anyRequest().authenticated()
            )
            .addFilterBefore(jwtAuthenticationFilter, UsernamePasswordAuthenticationFilter.class);

        return http.build();
    }

    @Bean
    public PasswordEncoder passwordEncoder() {
        return new BCryptPasswordEncoder();
    }
}
```

**æ­¥é©Ÿ 3ï¼šå»ºç«‹ CORS é…ç½®**

å»ºç«‹ `backend/src/main/java/com/crypto/dashboard/config/CorsConfig.java`ï¼š

```java
package com.crypto.dashboard.config;

import org.springframework.beans.factory.annotation.Value;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.web.cors.CorsConfiguration;
import org.springframework.web.cors.CorsConfigurationSource;
import org.springframework.web.cors.UrlBasedCorsConfigurationSource;

import java.util.Arrays;

@Configuration
public class CorsConfig {

    @Value("${cors.allowed-origins}")
    private String allowedOrigins;

    @Bean
    public CorsConfigurationSource corsConfigurationSource() {
        CorsConfiguration configuration = new CorsConfiguration();
        configuration.setAllowedOrigins(Arrays.asList(allowedOrigins.split(",")));
        configuration.setAllowedMethods(Arrays.asList("GET", "POST", "PUT", "DELETE", "OPTIONS"));
        configuration.setAllowedHeaders(Arrays.asList("*"));
        configuration.setAllowCredentials(true);

        UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();
        source.registerCorsConfiguration("/**", configuration);
        return source;
    }
}
```

#### Day 8ï¼šæ¸¬è©¦å¾Œç«¯ API

**å•Ÿå‹•å¾Œç«¯**

```bash
cd backend
mvn spring-boot:run
```

**ä½¿ç”¨ Postman æ¸¬è©¦**

1. **è¨»å†Š API**
   - URL: `POST http://localhost:8080/api/auth/register`
   - Body (JSON):
     ```json
     {
       "username": "testuser",
       "email": "test@example.com",
       "password": "password123"
     }
     ```

2. **ç™»å…¥ API**
   - URL: `POST http://localhost:8080/api/auth/login`
   - Body (JSON):
     ```json
     {
       "email": "test@example.com",
       "password": "password123"
     }
     ```
   - è¤‡è£½å›æ‡‰ä¸­çš„ `token`

3. **æ¸¬è©¦æ”¶è— API**
   - URL: `GET http://localhost:8080/api/favorites`
   - Headers: `Authorization: Bearer {ä½ çš„token}`

#### å­¸ç¿’æª¢æŸ¥é»
- [ ] ç†è§£ Spring Security çš„éæ¿¾å™¨éˆ
- [ ] ç†è§£ JWT èªè­‰æµç¨‹
- [ ] ç†è§£ CORS çš„ä½œç”¨
- [ ] æˆåŠŸæ¸¬è©¦æ‰€æœ‰ API

**Gemini æç¤º**ï¼š
- è§£é‡‹ç‚ºä»€éº¼éœ€è¦ JWT éæ¿¾å™¨
- è§£é‡‹ `@RestControllerAdvice` çš„ä½œç”¨
- ç¢ºèªå­¸ç¿’è€…å¯ä»¥æˆåŠŸæ¸¬è©¦ API

---

## ğŸ¨ ç¬¬ä¸‰éšæ®µï¼šå‰ç«¯åŸºç¤å»ºè¨­ï¼ˆç¬¬ 6-8 é€±ï¼‰

### Week 6ï¼šVue Router èˆ‡å°ˆæ¡ˆçµæ§‹

#### ç›®æ¨™
å»ºç«‹å‰ç«¯å°ˆæ¡ˆçµæ§‹å’Œè·¯ç”±ç³»çµ±

#### Day 1-2ï¼šæ¸…ç†åˆå§‹å°ˆæ¡ˆèˆ‡å»ºç«‹è³‡æ–™å¤¾çµæ§‹

**æ­¥é©Ÿ 1ï¼šæ¸…ç† Vite é è¨­æª”æ¡ˆ**

```bash
cd frontend/src

# åˆªé™¤ä¸éœ€è¦çš„æª”æ¡ˆ
rm -rf assets/*.svg
rm components/HelloWorld.vue
```

**æ­¥é©Ÿ 2ï¼šå»ºç«‹å®Œæ•´çš„è³‡æ–™å¤¾çµæ§‹**

```bash
cd frontend/src
mkdir -p {components,views,stores,router,utils,assets/images,locales}
```

æœ€çµ‚çµæ§‹ï¼š
```
frontend/src/
â”œâ”€â”€ assets/          # éœæ…‹è³‡æº
â”‚   â””â”€â”€ images/
â”œâ”€â”€ components/      # å…±ç”¨å…ƒä»¶
â”œâ”€â”€ views/           # é é¢å…ƒä»¶
â”œâ”€â”€ stores/          # Pinia Stores
â”œâ”€â”€ router/          # è·¯ç”±é…ç½®
â”œâ”€â”€ utils/           # å·¥å…·å‡½æ•¸
â”œâ”€â”€ locales/         # åœ‹éš›åŒ–èªè¨€æª”
â”œâ”€â”€ App.vue
â””â”€â”€ main.js
```

#### Day 3-4ï¼šé…ç½® Vue Router

**æ­¥é©Ÿ 1ï¼šå»ºç«‹è·¯ç”±é…ç½®**

å»ºç«‹ `frontend/src/router/index.js`ï¼š

```javascript
import { createRouter, createWebHistory } from 'vue-router'

const router = createRouter({
  history: createWebHistory(import.meta.env.BASE_URL),
  routes: [
    {
      path: '/login',
      name: 'login',
      component: () => import('../views/LoginView.vue'),
      meta: { requiresGuest: true }
    },
    {
      path: '/register',
      name: 'register',
      component: () => import('../views/RegisterView.vue'),
      meta: { requiresGuest: true }
    },
    {
      path: '/',
      component: () => import('../components/MainLayout.vue'),
      meta: { requiresAuth: true },
      children: [
        {
          path: '',
          redirect: '/dashboard'
        },
        {
          path: 'dashboard',
          name: 'dashboard',
          component: () => import('../views/DashboardView.vue')
        },
        {
          path: 'market',
          name: 'market',
          component: () => import('../views/MarketListView.vue')
        },
        {
          path: 'coin/:id',
          name: 'coin-detail',
          component: () => import('../views/CoinDetailView.vue')
        },
        {
          path: 'watchlist',
          name: 'watchlist',
          component: () => import('../views/WatchlistView.vue')
        },
        {
          path: 'compare',
          name: 'compare',
          component: () => import('../views/CompareView.vue')
        },
        {
          path: 'profile',
          name: 'profile',
          component: () => import('../views/ProfileView.vue')
        },
        {
          path: 'admin',
          name: 'admin',
          component: () => import('../views/AdminView.vue'),
          meta: { requiresAdmin: true }
        }
      ]
    }
  ]
})

// è·¯ç”±å®ˆè¡›
router.beforeEach((to, from, next) => {
  const isAuthenticated = localStorage.getItem('authToken')
  const user = JSON.parse(localStorage.getItem('user') || '{}')

  // è™•ç†æ ¹è·¯å¾‘
  if (to.path === '/' && isAuthenticated) {
    if (user.role === 'admin') {
      next('/admin')
      return
    } else {
      next('/dashboard')
      return
    }
  }

  if (to.meta.requiresAuth && !isAuthenticated) {
    next('/login')
  } else if (to.meta.requiresGuest && isAuthenticated) {
    next(user.role === 'admin' ? '/admin' : '/dashboard')
  } else if (to.meta.requiresAdmin && user.role !== 'admin') {
    next('/dashboard')
  } else {
    next()
  }
})

export default router
```

**æ­¥é©Ÿ 2ï¼šä¿®æ”¹ main.js**

ç·¨è¼¯ `frontend/src/main.js`ï¼š

```javascript
import { createApp } from 'vue'
import { createPinia } from 'pinia'
import App from './App.vue'
import router from './router'
import './style.css'

const app = createApp(App)

app.use(createPinia())
app.use(router)

app.mount('#app')
```

#### Day 5-7ï¼šå»ºç«‹åŸºç¤å…ƒä»¶

**å…ƒä»¶ 1ï¼šMainLayout.vue**

å»ºç«‹ `frontend/src/components/MainLayout.vue`ï¼š

```vue
<template>
  <div class="layout">
    <Sidebar />
    <div class="main-content">
      <Navbar />
      <div class="page-container">
        <router-view />
      </div>
    </div>
  </div>
</template>

<script setup>
import Sidebar from './Sidebar.vue'
import Navbar from './Navbar.vue'
</script>

<style scoped>
.layout {
  display: flex;
  min-height: 100vh;
  background: #0f1419;
}

.main-content {
  flex: 1;
  margin-left: 250px;
  transition: margin-left 0.3s;
}

.page-container {
  padding: 20px;
  max-width: 1400px;
  margin: 0 auto;
}
</style>
```

**å…ƒä»¶ 2ï¼šNavbar.vue**

å»ºç«‹ `frontend/src/components/Navbar.vue`ï¼š

```vue
<template>
  <nav class="navbar">
    <div class="navbar-brand">
      <h1>CoinVue å¹£æ™¯</h1>
    </div>
    <div class="navbar-actions">
      <button @click="handleLogout" class="logout-btn">
        ç™»å‡º
      </button>
    </div>
  </nav>
</template>

<script setup>
import { useRouter } from 'vue-router'

const router = useRouter()

const handleLogout = () => {
  localStorage.removeItem('authToken')
  localStorage.removeItem('user')
  router.push('/login')
}
</script>

<style scoped>
.navbar {
  background: #1a1f2e;
  padding: 15px 30px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  border-bottom: 1px solid #2a3142;
}

.navbar-brand h1 {
  color: #fff;
  font-size: 20px;
  margin: 0;
}

.logout-btn {
  background: #ef4444;
  color: white;
  border: none;
  padding: 8px 16px;
  border-radius: 6px;
  cursor: pointer;
  transition: background 0.2s;
}

.logout-btn:hover {
  background: #dc2626;
}
</style>
```

**å…ƒä»¶ 3ï¼šSidebar.vue**

å»ºç«‹ `frontend/src/components/Sidebar.vue`ï¼š

```vue
<template>
  <aside class="sidebar">
    <div class="sidebar-menu">
      <router-link
        v-for="item in menuItems"
        :key="item.name"
        :to="item.path"
        class="menu-item"
        active-class="active"
      >
        <span>{{ item.label }}</span>
      </router-link>
    </div>
  </aside>
</template>

<script setup>
import { computed } from 'vue'

const user = JSON.parse(localStorage.getItem('user') || '{}')

const menuItems = computed(() => {
  const items = []

  if (user.role === 'admin') {
    items.push({ name: 'admin', path: '/admin', label: 'ç®¡ç†å¾Œå°' })
  } else {
    items.push(
      { name: 'dashboard', path: '/dashboard', label: 'å„€è¡¨æ¿' },
      { name: 'market', path: '/market', label: 'å¸‚å ´ç¸½è¦½' },
      { name: 'watchlist', path: '/watchlist', label: 'æ”¶è—æ¸…å–®' },
      { name: 'compare', path: '/compare', label: 'å¹£ç¨®æ¯”è¼ƒ' }
    )
  }

  items.push({ name: 'profile', path: '/profile', label: 'å€‹äººè³‡æ–™' })

  return items
})
</script>

<style scoped>
.sidebar {
  position: fixed;
  left: 0;
  top: 0;
  width: 250px;
  height: 100vh;
  background: #1a1f2e;
  border-right: 1px solid #2a3142;
  padding: 20px 0;
}

.sidebar-menu {
  display: flex;
  flex-direction: column;
  gap: 5px;
  padding: 0 10px;
}

.menu-item {
  padding: 12px 20px;
  color: #94a3b8;
  text-decoration: none;
  border-radius: 8px;
  transition: all 0.2s;
}

.menu-item:hover {
  background: #2a3142;
  color: #fff;
}

.menu-item.active {
  background: #3b82f6;
  color: #fff;
}
</style>
```

#### å­¸ç¿’æª¢æŸ¥é»
- [ ] ç†è§£ Vue Router çš„æ‡¶åŠ è¼‰ï¼ˆå‹•æ…‹å°å…¥ï¼‰
- [ ] ç†è§£è·¯ç”±å®ˆè¡›çš„ä½œç”¨
- [ ] ç†è§£å·¢ç‹€è·¯ç”±çš„é…ç½®
- [ ] æˆåŠŸå»ºç«‹åŸºç¤ä½ˆå±€å…ƒä»¶

**Gemini æç¤º**ï¼š
- è§£é‡‹ `meta` æ¬„ä½çš„ä½œç”¨
- è§£é‡‹è·¯ç”±å®ˆè¡›çš„åŸ·è¡Œé †åº
- è§£é‡‹ç‚ºä»€éº¼ä½¿ç”¨ `localStorage` å„²å­˜èªè­‰è³‡è¨Š

---

### Week 7-8ï¼šPinia Store èˆ‡ API æ•´åˆ

#### ç›®æ¨™
å»ºç«‹ç‹€æ…‹ç®¡ç†å’Œ API è«‹æ±‚å·¥å…·

#### Day 1-3ï¼šå»ºç«‹ API å·¥å…·

**æ­¥é©Ÿ 1ï¼šå»ºç«‹ç’°å¢ƒè®Šæ•¸**

å»ºç«‹ `frontend/.env`ï¼š

```env
VITE_API_BASE_URL=http://localhost:8080/api
VITE_COINGECKO_API_KEY=CG-vczvnvBTsqG7Z8EVB7KRb3ii
```

**æ­¥é©Ÿ 2ï¼šå»ºç«‹çµ±ä¸€ API å·¥å…·**

å»ºç«‹ `frontend/src/utils/api.js`ï¼š

```javascript
import axios from 'axios'

const API_BASE_URL = import.meta.env.VITE_API_BASE_URL

// å»ºç«‹ axios å¯¦ä¾‹
const apiClient = axios.create({
  baseURL: API_BASE_URL,
  headers: {
    'Content-Type': 'application/json'
  }
})

// è«‹æ±‚æ””æˆªå™¨ï¼šè‡ªå‹•æ·»åŠ  Token
apiClient.interceptors.request.use(
  (config) => {
    const token = localStorage.getItem('authToken')
    if (token) {
      config.headers.Authorization = `Bearer ${token}`
    }
    return config
  },
  (error) => {
    return Promise.reject(error)
  }
)

// å›æ‡‰æ””æˆªå™¨ï¼šè™•ç† 401 éŒ¯èª¤
apiClient.interceptors.response.use(
  (response) => response,
  (error) => {
    if (error.response?.status === 401) {
      localStorage.removeItem('authToken')
      localStorage.removeItem('user')
      window.location.href = '/login'
    }
    return Promise.reject(error)
  }
)

// èªè­‰ API
export const authApi = {
  register: (data) => apiClient.post('/auth/register', data),
  login: (data) => apiClient.post('/auth/login', data),
  logout: () => apiClient.post('/auth/logout')
}

// æ”¶è— API
export const favoriteApi = {
  getFavorites: () => apiClient.get('/favorites'),
  addFavorite: (coinId) => apiClient.post(`/favorites?coinId=${coinId}`),
  removeFavorite: (coinId) => apiClient.delete(`/favorites/${coinId}`),
  clearFavorites: () => apiClient.delete('/favorites/all')
}

// å¹£ç¨® APIï¼ˆé€éå¾Œç«¯ proxyï¼‰
export const coinApi = {
  getList: (page = 1, perPage = 50) =>
    apiClient.get(`/coins?page=${page}&perPage=${perPage}`),
  getDetail: (id) => apiClient.get(`/coins/${id}`)
}

export default apiClient
```

#### Day 4-7ï¼šå»ºç«‹ Pinia Stores

**Store 1ï¼šuseCoinsStore**

å»ºç«‹ `frontend/src/stores/useCoinsStore.js`ï¼š

```javascript
import { defineStore } from 'pinia'
import { coinApi } from '../utils/api'

const CACHE_TTL = 5 * 60 * 1000 // 5 åˆ†é˜

export const useCoinsStore = defineStore('coins', {
  state: () => ({
    cache: {},
    fetchedAt: {},
    isFetching: false,
    error: null
  }),

  actions: {
    async fetchCoins({ perPage = 50, page = 1, force = false } = {}) {
      const key = `${perPage}-${page}`
      const now = Date.now()
      const cached = this.cache[key]

      // æª¢æŸ¥å¿«å–
      if (!force && cached && now - (this.fetchedAt[key] || 0) < CACHE_TTL) {
        return cached
      }

      this.isFetching = true
      this.error = null

      try {
        const response = await coinApi.getList(page, perPage)
        const coins = response.data
        this.cache[key] = coins
        this.fetchedAt[key] = now
        return coins
      } catch (error) {
        console.error('Fetch coins failed:', error)
        this.error = 'ç„¡æ³•å–å¾—å¹£ç¨®è³‡æ–™'
        return []
      } finally {
        this.isFetching = false
      }
    }
  }
})
```

**Store 2ï¼šuseFavoritesStore**

å»ºç«‹ `frontend/src/stores/useFavoritesStore.js`ï¼š

```javascript
import { defineStore } from 'pinia'
import { favoriteApi } from '../utils/api'

export const useFavoritesStore = defineStore('favorites', {
  state: () => ({
    favorites: [],
    isLoading: false,
    error: null
  }),

  getters: {
    isFavorite: (state) => (coinId) => {
      return state.favorites.includes(coinId)
    }
  },

  actions: {
    async loadFavorites() {
      if (this.isLoading) return

      this.isLoading = true
      this.error = null

      try {
        const response = await favoriteApi.getFavorites()
        this.favorites = response.data
      } catch (error) {
        console.error('Load favorites failed:', error)
        this.error = 'ç„¡æ³•è¼‰å…¥æ”¶è—æ¸…å–®'
      } finally {
        this.isLoading = false
      }
    },

    async addFavorite(coinId) {
      try {
        await favoriteApi.addFavorite(coinId)
        this.favorites.push(coinId)
      } catch (error) {
        console.error('Add favorite failed:', error)
        throw error
      }
    },

    async removeFavorite(coinId) {
      try {
        await favoriteApi.removeFavorite(coinId)
        this.favorites = this.favorites.filter(id => id !== coinId)
      } catch (error) {
        console.error('Remove favorite failed:', error)
        throw error
      }
    },

    async clearFavorites() {
      try {
        await favoriteApi.clearFavorites()
        this.favorites = []
      } catch (error) {
        console.error('Clear favorites failed:', error)
        throw error
      }
    }
  }
})
```

#### å­¸ç¿’æª¢æŸ¥é»
- [ ] ç†è§£ Pinia Store çš„çµæ§‹ï¼ˆstateã€gettersã€actionsï¼‰
- [ ] ç†è§£ axios æ””æˆªå™¨çš„ä½œç”¨
- [ ] ç†è§£å¿«å–æ©Ÿåˆ¶çš„å¯¦ä½œ
- [ ] æˆåŠŸå»ºç«‹ API å·¥å…·å’Œ Stores

**Gemini æç¤º**ï¼š
- è§£é‡‹ç‚ºä»€éº¼éœ€è¦å¿«å–æ©Ÿåˆ¶
- è§£é‡‹ axios æ””æˆªå™¨çš„æ‡‰ç”¨å ´æ™¯
- è§£é‡‹ Pinia èˆ‡ Vuex çš„å·®ç•°

---

## ğŸ”— ç¬¬å››éšæ®µï¼šå‰å¾Œç«¯æ•´åˆï¼ˆç¬¬ 9-10 é€±ï¼‰

### Week 9ï¼šæ ¸å¿ƒé é¢å¯¦ä½œ

#### ç›®æ¨™
å¯¦ä½œç™»å…¥ã€è¨»å†Šã€Dashboardã€Market é é¢

#### Day 1-2ï¼šç™»å…¥èˆ‡è¨»å†Šé é¢

**LoginView.vue**

å»ºç«‹ `frontend/src/views/LoginView.vue`ï¼š

```vue
<template>
  <div class="auth-page">
    <div class="auth-card">
      <h1>ç™»å…¥ CoinVue</h1>
      <form @submit.prevent="handleLogin">
        <div class="form-group">
          <label>Email</label>
          <input
            v-model="form.email"
            type="email"
            placeholder="è«‹è¼¸å…¥ Email"
            required
          />
        </div>
        <div class="form-group">
          <label>å¯†ç¢¼</label>
          <input
            v-model="form.password"
            type="password"
            placeholder="è«‹è¼¸å…¥å¯†ç¢¼"
            required
          />
        </div>
        <div v-if="error" class="error-message">
          {{ error }}
        </div>
        <button type="submit" class="btn-primary" :disabled="isLoading">
          {{ isLoading ? 'ç™»å…¥ä¸­...' : 'ç™»å…¥' }}
        </button>
      </form>
      <p class="auth-link">
        é‚„æ²’æœ‰å¸³è™Ÿï¼Ÿ<router-link to="/register">ç«‹å³è¨»å†Š</router-link>
      </p>
    </div>
  </div>
</template>

<script setup>
import { ref } from 'vue'
import { useRouter } from 'vue-router'
import { authApi } from '../utils/api'

const router = useRouter()

const form = ref({
  email: '',
  password: ''
})

const isLoading = ref(false)
const error = ref(null)

const handleLogin = async () => {
  isLoading.value = true
  error.value = null

  try {
    const response = await authApi.login(form.value)
    const { token, user } = response.data

    localStorage.setItem('authToken', token)
    localStorage.setItem('user', JSON.stringify(user))

    // æ ¹æ“šè§’è‰²è·³è½‰
    router.push(user.role === 'admin' ? '/admin' : '/dashboard')
  } catch (err) {
    error.value = err.response?.data?.error || 'ç™»å…¥å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦'
  } finally {
    isLoading.value = false
  }
}
</script>

<style scoped>
.auth-page {
  min-height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
}

.auth-card {
  background: white;
  padding: 40px;
  border-radius: 12px;
  box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
  width: 100%;
  max-width: 400px;
}

.auth-card h1 {
  margin-bottom: 30px;
  text-align: center;
  color: #333;
}

.form-group {
  margin-bottom: 20px;
}

.form-group label {
  display: block;
  margin-bottom: 8px;
  color: #555;
  font-weight: 500;
}

.form-group input {
  width: 100%;
  padding: 12px;
  border: 1px solid #ddd;
  border-radius: 6px;
  font-size: 14px;
}

.form-group input:focus {
  outline: none;
  border-color: #667eea;
}

.btn-primary {
  width: 100%;
  padding: 12px;
  background: #667eea;
  color: white;
  border: none;
  border-radius: 6px;
  font-size: 16px;
  cursor: pointer;
  transition: background 0.2s;
}

.btn-primary:hover:not(:disabled) {
  background: #5568d3;
}

.btn-primary:disabled {
  opacity: 0.6;
  cursor: not-allowed;
}

.error-message {
  color: #ef4444;
  background: #fee2e2;
  padding: 10px;
  border-radius: 6px;
  margin-bottom: 15px;
  font-size: 14px;
}

.auth-link {
  text-align: center;
  margin-top: 20px;
  color: #666;
}

.auth-link a {
  color: #667eea;
  text-decoration: none;
  font-weight: 500;
}

.auth-link a:hover {
  text-decoration: underline;
}
</style>
```

**RegisterView.vue** - çµæ§‹é¡ä¼¼ï¼Œå°‡ç™»å…¥æ”¹ç‚ºè¨»å†Šå³å¯

#### Day 3-7ï¼šDashboard èˆ‡ Market é é¢

**DashboardView.vue** - ç°¡åŒ–ç‰ˆç¯„ä¾‹ï¼š

```vue
<template>
  <div class="dashboard">
    <h1>æ­¡è¿å›ä¾†ï¼Œ{{ user.username }}</h1>

    <div class="stats-grid">
      <div class="stat-card">
        <h3>ç¸½å¸‚å€¼</h3>
        <p class="stat-value">$2.5T</p>
      </div>
      <div class="stat-card">
        <h3>24h äº¤æ˜“é‡</h3>
        <p class="stat-value">$150B</p>
      </div>
      <div class="stat-card">
        <h3>BTC ä¸»å°ç‡</h3>
        <p class="stat-value">45.2%</p>
      </div>
    </div>

    <h2>ç†±é–€å¹£ç¨®</h2>
    <div v-if="isLoading">è¼‰å…¥ä¸­...</div>
    <div v-else-if="error">{{ error }}</div>
    <div v-else class="coin-list">
      <CoinCard v-for="coin in coins" :key="coin.id" :coin="coin" />
    </div>
  </div>
</template>

<script setup>
import { ref, onMounted } from 'vue'
import { useCoinsStore } from '../stores/useCoinsStore'
import CoinCard from '../components/CoinCard.vue'

const coinsStore = useCoinsStore()
const user = JSON.parse(localStorage.getItem('user') || '{}')

const coins = ref([])
const isLoading = ref(false)
const error = ref(null)

onMounted(async () => {
  isLoading.value = true
  try {
    coins.value = await coinsStore.fetchCoins({ perPage: 10 })
  } catch (err) {
    error.value = 'ç„¡æ³•è¼‰å…¥å¹£ç¨®è³‡æ–™'
  } finally {
    isLoading.value = false
  }
})
</script>

<style scoped>
.dashboard {
  padding: 20px;
}

.stats-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 20px;
  margin: 30px 0;
}

.stat-card {
  background: #1a1f2e;
  padding: 20px;
  border-radius: 12px;
  border: 1px solid #2a3142;
}

.stat-card h3 {
  color: #94a3b8;
  font-size: 14px;
  margin-bottom: 10px;
}

.stat-value {
  color: #fff;
  font-size: 24px;
  font-weight: bold;
}

.coin-list {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
  gap: 20px;
}
</style>
```

#### å­¸ç¿’æª¢æŸ¥é»
- [ ] æˆåŠŸå¯¦ä½œç™»å…¥è¨»å†Šé é¢
- [ ] ç†è§£è¡¨å–®é©—è­‰èˆ‡éŒ¯èª¤è™•ç†
- [ ] æˆåŠŸä¸²æ¥å¾Œç«¯ API
- [ ] ç†è§£èªè­‰æµç¨‹ï¼ˆToken å„²å­˜èˆ‡ä½¿ç”¨ï¼‰

**Gemini æç¤º**ï¼š
- ç¢ºèªå­¸ç¿’è€…å¯ä»¥æˆåŠŸç™»å…¥ä¸¦è·³è½‰
- è§£é‡‹ localStorage çš„å®‰å…¨æ€§è€ƒé‡
- è§£é‡‹å‰å¾Œç«¯è³‡æ–™æµç¨‹

---

### Week 10ï¼šæ”¶è—èˆ‡è©³æƒ…é é¢

ï¼ˆæ­¤è™•æ‡‰åŒ…å« WatchlistViewã€CoinDetailView çš„å¯¦ä½œï¼‰

---

## âš¡ ç¬¬äº”éšæ®µï¼šé€²éšåŠŸèƒ½å¯¦ä½œï¼ˆç¬¬ 11-13 é€±ï¼‰

ï¼ˆæ­¤è™•æ‡‰åŒ…å« Admin Panelã€å…¬å‘Šç³»çµ±ã€é€²éšç¯©é¸ã€åœ‹éš›åŒ–ç­‰åŠŸèƒ½çš„å¯¦ä½œï¼‰

---

## ğŸ“¦ ç¬¬å…­éšæ®µï¼šå„ªåŒ–èˆ‡éƒ¨ç½²ï¼ˆç¬¬ 14-15 é€±ï¼‰

ï¼ˆæ­¤è™•æ‡‰åŒ…å«æ•ˆèƒ½å„ªåŒ–ã€å®‰å…¨æ€§å¼·åŒ–ã€Docker éƒ¨ç½²ã€CI/CD ç­‰å…§å®¹ï¼‰

---

## ğŸ“ å­¸ç¿’å»ºè­°

### çµ¦å­¸ç¿’è€…çš„å»ºè­°
1. **ä¸è¦è·³éæ­¥é©Ÿ**ï¼šæ¯å€‹éšæ®µéƒ½å¾ˆé‡è¦ï¼Œæ‰“å¥½åŸºç¤æ‰èƒ½é †åˆ©é€²è¡Œ
2. **å‹•æ‰‹å¯¦ä½œ**ï¼šå…‰çœ‹ä¸åšæ˜¯å­¸ä¸æœƒçš„ï¼Œä¸€å®šè¦è¦ªè‡ªå¯«ä»£ç¢¼
3. **é‡åˆ°å•é¡Œå…ˆæ€è€ƒ**ï¼šå˜—è©¦è‡ªå·±è§£æ±ºï¼Œå¯¦åœ¨ä¸è¡Œå†è©¢å• Gemini
4. **å®šæœŸå›é¡§**ï¼šæ¯é€±å›é¡§å·²å®Œæˆçš„éƒ¨åˆ†ï¼Œç¢ºä¿çŸ¥è­˜é€£è²«
5. **åšç­†è¨˜**ï¼šè¨˜éŒ„å­¸ç¿’éç¨‹ä¸­çš„é‡é»å’Œå¿ƒå¾—

### çµ¦ Gemini çš„å»ºè­°
1. **ä¿æŒè€å¿ƒ**ï¼šå­¸ç¿’è€…å¯èƒ½éœ€è¦æ™‚é–“æ¶ˆåŒ–ï¼Œä¸è¦æ€¥æ–¼æ¨é€²
2. **æä¾›ç¯„ä¾‹**ï¼šçµ¦å‡ºå®Œæ•´ã€å¯é‹è¡Œçš„ä»£ç¢¼ç¯„ä¾‹
3. **è§£é‡‹åŸç†**ï¼šä¸åªæ˜¯ã€Œæ€éº¼åšã€ï¼Œæ›´è¦è§£é‡‹ã€Œç‚ºä»€éº¼ã€
4. **é¼“å‹µå­¸ç¿’è€…**ï¼šé©æ™‚çµ¦äºˆæ­£é¢å›é¥‹ï¼Œæå‡å­¸ç¿’å‹•åŠ›
5. **éˆæ´»èª¿æ•´**ï¼šæ ¹æ“šå­¸ç¿’è€…çš„ç¨‹åº¦èª¿æ•´æ•™å­¸ç¯€å¥

---

## ğŸ”š çµèª

é€™æ˜¯ä¸€å€‹å®Œæ•´çš„å…¨ç«¯å°ˆæ¡ˆï¼Œæ¶µè“‹äº†ç¾ä»£ Web é–‹ç™¼çš„å„å€‹å±¤é¢ã€‚é€éé€™å€‹å°ˆæ¡ˆï¼Œä½ å°‡å­¸æœƒï¼š

**å‰ç«¯æŠ€èƒ½**
- Vue 3 Composition API
- Pinia ç‹€æ…‹ç®¡ç†
- Vue Router è·¯ç”±ç®¡ç†
- å…ƒä»¶åŒ–é–‹ç™¼
- API æ•´åˆèˆ‡éŒ¯èª¤è™•ç†

**å¾Œç«¯æŠ€èƒ½**
- Spring Boot æ¡†æ¶
- Spring Security èˆ‡ JWT èªè­‰
- JPA/Hibernate ORM
- RESTful API è¨­è¨ˆ
- è³‡æ–™åº«è¨­è¨ˆèˆ‡å„ªåŒ–

**å…¨ç«¯æŠ€èƒ½**
- å‰å¾Œç«¯åˆ†é›¢æ¶æ§‹
- API è¨­è¨ˆèˆ‡æ–‡æª”
- å®‰å…¨æ€§æœ€ä½³å¯¦è¸
- éƒ¨ç½²èˆ‡ç¶­é‹

ç¥ä½ å­¸ç¿’é †åˆ©ï¼åŠ æ²¹ï¼ğŸ’ª

---

**æ–‡æª”ç‰ˆæœ¬**ï¼š1.0
**å»ºç«‹æ—¥æœŸ**ï¼š2025-12-12
**é©ç”¨å°ˆæ¡ˆç‰ˆæœ¬**ï¼šCoinVue v1.2.0
